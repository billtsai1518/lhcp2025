"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[5462],{52825:(e,t,i)=>{var a=i(86326),n=i(35623),r=(i(42383),i(29079)),s=i(97598),l=i.n(s),o=i(96478),d=i(99323),c=i(23507),m=i(33864),_=i(46145),u=i(29481),g=i(49528);function p({metadataURL:e,previewURL:t,sendURL:i,onClose:n}){const[r,s]=(0,a.useState)(0),{data:l,loading:o}=(0,u.Ku)(e),{senders:p=[],recipients:f=[],subject:y,body:v,placeholders:b=[]}=l||{};return o?a.createElement(d.A,{active:!0,page:!0,inverted:!0},a.createElement(c.A,null)):a.createElement(m.V,{onSubmit:async e=>{let t;try{t=await g.indicoAxios.post(i,e)}catch(e){return(0,_.handleSubmitError)(e)}s(t.data.count),setTimeout((()=>n()),5e3)},onClose:n,senders:p,recipients:f,previewURL:t,placeholders:b,initialFormValues:{subject:y,body:v},sentEmailsCount:r})}p.propTypes={metadataURL:l().string.isRequired,previewURL:l().string.isRequired,sendURL:l().string.isRequired,onClose:l().func.isRequired};const f=r.Ay.bind(null,{endpoint:"event_registration.api_invitations_reminders_metadata",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"invitations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reminders",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),y=r.Ay.bind(null,{endpoint:"event_registration.api_invitations_reminders_preview",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"invitations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reminders",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/"),v=r.Ay.bind(null,{endpoint:"event_registration.api_invitations_reminders_send",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"invitations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reminders",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/");function b({eventId:e,regformId:t,hasPendingInvitations:i}){const[n,r]=(0,a.useState)(!1),s=f({event_id:e,reg_form_id:t}),l=y({event_id:e,reg_form_id:t}),d=v({event_id:e,reg_form_id:t});return a.createElement(a.Fragment,null,a.createElement("button",{type:"button",className:"i-button icon-mail",disabled:!i,onClick:()=>r(!0)},a.createElement(o.Translate,null,"Send reminders")),n&&a.createElement(p,{metadataURL:s,previewURL:l,sendURL:d,onClose:()=>r(!1)}))}b.propTypes={eventId:l().number.isRequired,regformId:l().number.isRequired,hasPendingInvitations:l().bool.isRequired},function(e){function t({eventId:e,regformId:t,hasPendingInvitations:i}){const r=document.getElementById("email-pending-invitations-container");n.render(a.createElement(b,{eventId:e,regformId:t,hasPendingInvitations:i}),r)}window.setupInvitationPage=function({eventId:e,regformId:i,hasPendingInvitations:a}){$("#invitation-list").on("indico:confirmed",".js-invitation-action",(function(a){a.preventDefault();const n=$(this);$.ajax({url:n.data("href"),method:n.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(a){$("#invitation-list").html(a.invitation_list),t({eventId:e,regformId:i,hasPendingInvitations:a.has_pending_invitations})}})})),$(".js-invite-user").ajaxDialog({onClose(a){a&&($("#invitation-list").html(a.invitation_list),t({eventId:e,regformId:i,hasPendingInvitations:a.has_pending_invitations}))}}),t({eventId:e,regformId:i,hasPendingInvitations:a})}}();var h=i(65035),E=i(25584);window.setupRegistrationList=function(){function e(){$("table.i-table input.select-row").on("change",(function(){$(".regform-download-attachments").toggleClass("disabled",!$(".list input:checkbox:checked[data-has-files=true]").length)})).trigger("change"),$("table.i-table input.select-row").on("change",(function(){$(".regform-download-documents").toggleClass("disabled",!$(".list input:checkbox:checked[data-has-documents=true]").length)})).trigger("change")}setupListGenerator(),$("body").on("click","#preview-email",(function(){const e=$(this);ajaxDialog({url:e.data("href"),title:E.$T.gettext("Email Preview"),method:"POST",data:()=>({registration_id:getSelectedRows()[0],subject:$("#subject").val(),body:$("#body").val()})})})),$(".registrations").on("indico:confirmed",".js-delete-registrations",(function(e){e.preventDefault();const t=$(this),i=getSelectedRows(),a=E.$T.ngettext("Do you really want to delete the selected registration?","Do you really want to delete the {0} selected registrations?",i.length).format(i.length);confirmPrompt(a).then((function(){$.ajax({url:t.data("href"),method:t.data("method"),data:{registration_id:i},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(){for(let e=0;e<i.length;e++)$(`#registration-${i[e]}`).fadeOut("fast",(function(){$(this).remove()}))}})}))})),$(".registrations").on("indico:confirmed",".js-modify-status",(function(t){t.preventDefault();const i=$(this),a=getSelectedRows();$.ajax({url:i.data("href"),method:i.data("method"),data:{registration_id:a,flag:i.data("flag")},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(t){t&&($(".list-content").html(t.html),handleSelectedRowHighlight(!0),e(),setupTableSorter())}})})),$(".js-add-user").on("click",(async()=>{const e=await(0,h.showUserSearch)({withExternalUsers:!0,single:!0,alwaysConfirm:!0});if(e){const t=$(".js-add-user").data("href");location.href=build_url(t,{user:e})}})),$(".js-add-multiple-users").ajaxDialog({dialogClasses:"add-multiple-users-dialog",onClose(t){t&&($(".list-content").html(t.html),handleSelectedRowHighlight(!0),e(),setupTableSorter())}}),e()};var D=i(73885),T=i(47279),q=i(77940),R=i(4005);const w=l().oneOf(["hide_all","show_with_consent","show_all"]);function x({publishToParticipants:e,publishToPublic:t,value:i,useFinalForms:n,...r}){if("hide_all"===e&&"hide_all"===t)return a.createElement(o.Translate,null,"Your participation will only be visible to organizers of this event.");if("show_all"===e&&"hide_all"===t)return a.createElement(o.Translate,null,"Your participation will be displayed to other participants of this event.");if("show_all"===e&&"show_all"===t)return a.createElement(o.Translate,null,"Your participation will be displayed to everyone who can see this event.");{const s=[];return"show_with_consent"!==e&&"nobody"!==i||s.push({key:"nobody",value:"nobody",label:o.Translate.string("Do not display my participation to anyone"),disabled:"show_with_consent"!==e}),s.push({key:"participants",value:"participants",label:o.Translate.string("Display my participation only to other participants of this event")}),"show_with_consent"!==t&&"all"!==i||s.push({key:"all",value:"all",label:o.Translate.string("Display my participation to everyone who can see this event"),disabled:"show_with_consent"!==t}),n?a.createElement(_.FinalField,(0,q.A)({className:"events-registration-client-js-components-___ConsentToPublishDropdown-module__select___h3oek "+(r&&r.className||""),component:R.Select,options:s,required:!0,value:i},r,{id:"input-consent-to-publish"})):a.createElement(R.Select,(0,q.A)({className:"events-registration-client-js-components-___ConsentToPublishDropdown-module__select___h3oek "+(r&&r.className||""),options:s,value:i,required:!0},r,{id:"input-consent-to-publish"}))}}x.propTypes={publishToParticipants:w.isRequired,publishToPublic:w.isRequired,value:l().oneOf(["nobody","participants","all"]),useFinalForms:l().bool},x.defaultProps={value:null,useFinalForms:!1};const I=r.Ay.bind(null,{endpoint:"event_registration.api_registration_change_consent",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1},{data:"/",isDynamic:!1},{data:"consent",isDynamic:!1}]}]},"/");function A({locator:e,publishToParticipants:t,publishToPublic:i,initialConsentToPublish:n}){const[r,s]=(0,a.useState)(n),[l,o]=(0,a.useState)("");return a.createElement("div",{className:"events-registration-client-js-components-___ConsentToPublishEditor-module__consent-dropdown-container___0HGIs"},a.createElement(x,{publishToParticipants:t,publishToPublic:i,onChange:t=>async function(t){s(t),o("loading");try{await g.indicoAxios.post(I(e),{consent_to_publish:t}),o("success")}catch(e){return o("error"),s(r),(0,g.handleAxiosError)(e)}}(t.target.value),value:r,loading:"loading"===l,disabled:"loading"===l}),"success"===l&&a.createElement(T.A,{name:"check",color:"green"}),"error"===l&&a.createElement(T.A,{name:"x",color:"red"}))}A.propTypes={locator:l().object.isRequired,publishToParticipants:w.isRequired,publishToPublic:w.isRequired,initialConsentToPublish:l().oneOf(["nobody","participants","all"]).isRequired};var C=i(56237),P=i(16520),S=i(69655),N=i(71612),k=i(87597),F=i(89664),M=i(75313);function L({count:e}){return a.createElement(o.PluralTranslate,{count:e},a.createElement(o.Singular,null,a.createElement(o.Param,{name:"count",value:e})," participant registered anonymously."),a.createElement(o.Plural,null,a.createElement(o.Param,{name:"count",value:e})," participants registered anonymously."))}var O=i(64771),j=i(6841),U=i(80468),z=i(13805),Y=i(81976),V=i(81317),B=i(21673),H=i(32490);const Z={"./ParticipantTable.module.scss":{"cell-img":"events-registration-client-js-components-participant-list-___ParticipantTable-module__cell-img___zRFEV","icon-cell":"events-registration-client-js-components-participant-list-___ParticipantTable-module__icon-cell___rkXZD","participant-table-row":"events-registration-client-js-components-participant-list-___ParticipantTable-module__participant-table-row___BiyWi",unsortable:"events-registration-client-js-components-participant-list-___ParticipantTable-module__unsortable___csaeF"}};function J({table:e}){const t=e.rows.length,i=e.num_participants,n=i-t,r=n>0,[s,l]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[m,_]=(0,a.useState)([...e.rows]),u=t=>{const i=s===t?{[null]:"ascending",ascending:"descending",descending:null}[d]:"ascending",a=null===i?[...e.rows]:[...m].sort(((e,a)=>{const n=[e,a].map((e=>"string"==typeof t?e[t]:e.columns[t].text));let r;return n[0]===n[1]?0:(r=n.every((e=>"boolean"==typeof e))?n[0]>n[1]?-1:1:n[0].localeCompare(n[1]),r*("ascending"===i?1:-1))}));l(t),c(i),_(a)};return t>0?a.createElement(j.A,{fixed:!0,celled:!0,sortable:!0},a.createElement(U.A,null,a.createElement(z.A,null,e.show_checkin&&a.createElement(Y.A,{className:"events-registration-client-js-components-participant-list-___ParticipantTable-module__participant-table-row___BiyWi events-registration-client-js-components-participant-list-___ParticipantTable-module__icon-cell___rkXZD",onClick:()=>u("checked_in"),sorted:"checked_in"===s?d:void 0,title:o.Translate.string("Check-in status")},a.createElement(T.A,{name:"ticket"})),e.headers.map(((t,i)=>{const n=(t=>{const{rows:i}=e;return!i||!i.length||!i[0].columns[t].is_picture})(i);return a.createElement(Y.A,{key:i,onClick:n?()=>u(i):void 0,sorted:n&&s===i?d:void 0,title:t,className:(0,O.A)("participant-table-row "+(n?"":"unsortable"),Z,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},a.createElement("p",null,t))})))),a.createElement(V.A,null,m.map((t=>a.createElement(z.A,{key:t.id},e.show_checkin&&a.createElement(B.A,{textAlign:"center"},t.checked_in?a.createElement(T.A,{name:"check",color:"green"}):a.createElement(T.A,{name:"close",color:"red"})),t.columns.map(((e,t)=>a.createElement(B.A,{key:t,title:e.text},e.is_picture?e.text?a.createElement("img",{src:e.text,alt:"",className:"events-registration-client-js-components-participant-list-___ParticipantTable-module__cell-img___zRFEV"}):a.createElement("div",{className:"events-registration-client-js-components-participant-list-___ParticipantTable-module__cell-img___zRFEV"}):e.text))))))),r&&a.createElement(H.A,{fullWidth:!0},a.createElement(z.A,null,a.createElement(Y.A,{colSpan:e.headers.length+Number(e.show_checkin)},a.createElement(L,{count:n}))))):a.createElement(k.A,null,i>0?a.createElement(L,{count:n}):a.createElement(o.Translate,null,"No participants registered."))}function G({totalCount:e,hiddenCount:t}){const i=a.createElement("span",{className:"events-registration-client-js-components-participant-list-___ParticipantAccordion-module__participants-count-wrapper___jxWBS"},e," ",a.createElement(T.A,{name:"user"}));return t>0?a.createElement(P.A,{position:"left center",content:a.createElement(L,{count:t}),trigger:i}):i}function K({table:e,collapsible:t=!0,noTitle:i=!1}){const n=e.rows.length,r=e.num_participants,s=r-n,[l,d]=(0,a.useState)(!t||n>0);return a.createElement(a.Fragment,null,!i&&a.createElement(S.A,{active:l,onClick:t?()=>d(!l):void 0,className:"events-registration-client-js-components-participant-list-___ParticipantAccordion-module__accordion-title___KpRir"},t&&a.createElement(T.A,{name:"dropdown"}),a.createElement("p",null,e.title||a.createElement(o.Translate,null,"Participants")),a.createElement(G,{totalCount:r,hiddenCount:s})),a.createElement(N.A,{active:l},a.createElement(J,{table:e})))}function W({published:e,totalParticipantCount:t,tables:i,merged:n}){let r;return e?t<=0&&(r=a.createElement(o.Translate,null,"There are no registrations yet.")):r=a.createElement(o.Translate,null,"There are no published registrations."),r?a.createElement(k.A,{info:!0,size:"large"},a.createElement(F.A,null,a.createElement(T.A,{name:"info circle"}),r)):a.createElement(M.A,{fluid:!0},i.map(((e,t)=>a.createElement(K,{key:t,collapsible:1!==i.length,table:e,noTitle:n}))))}let Q=function(e){return e.GUEST="guest",e.PARTICIPANT="participant",e}({});const X=r.Ay.bind(null,{endpoint:"event_registration.manage_participant_list_preview",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"participant-list-preview",isDynamic:!1}]}]},"/");function ee({published:e,totalParticipantCount:t,tables:i,preview:n,eventId:r,merged:s}){let l;return n===Q.GUEST?l=a.createElement(C.A,{basic:!0,color:"blue",href:X({event_id:r}),className:"events-registration-client-js-components-participant-list-___ParticipantList-module__view-toggle___ZQwII"},a.createElement(T.A,{name:"user"}),a.createElement(o.Translate,null,"Show registered participant view instead")):n&&(l=a.createElement(C.A,{basic:!0,color:"blue",href:X({event_id:r,guest:1}),className:"events-registration-client-js-components-participant-list-___ParticipantList-module__view-toggle___ZQwII"},a.createElement(T.A,{name:"user secret"}),a.createElement(o.Translate,null,"Show unregistered guest view instead"))),a.createElement("section",null,l,a.createElement(W,{published:e,totalParticipantCount:t,tables:i,merged:s}))}var te=i(637),ie=i.n(te),ae=i(54219),ne=i(45423),re=i(503);const se=r.Ay.bind(null,{endpoint:"event_registration.api_registration_tags_assign",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1},{data:"/",isDynamic:!1},{data:"assign",isDynamic:!1}]}]},"/");function le({eventId:e,regformId:t,registrationId:i,assignedTags:n,allTags:r}){const[s,l]=(0,a.useState)(n),[d,c]=(0,a.useState)(!1),m=ie().differenceBy(r,s,"id");async function _({add:a=[],remove:n=[]}){try{await g.indicoAxios.post(se({reg_form_id:t,event_id:e}),{registration_id:[i],add:a,remove:n})}catch(e){return(0,g.handleAxiosError)(e)}}const u=a.createElement(R.IButton,{disabled:0===m.length},a.createElement(o.Translate,null,"Add"),a.createElement(T.A,{name:"caret down",style:{marginRight:0}}));return a.createElement(a.Fragment,null,a.createElement("div",{className:"icon icon-tag"}),a.createElement("div",{className:"text"},a.createElement("div",{className:"label"},a.createElement(o.Translate,null,"Tags")),a.createElement("div",{className:"events-registration-client-js-components-___RegistrationTagsEditableList-module__removable-tags-container___C2Usb",style:{marginTop:0===s.length?"0":"3px"}},0===s.length?a.createElement(o.Translate,null,"No tags assigned."):s.map((e=>a.createElement(ae.A,{size:"medium",key:e.title,className:"events-registration-client-js-components-___RegistrationTagsEditableList-module__registration-tag___nAtUC events-registration-client-js-components-___RegistrationTagsEditableList-module__removable___aNbCV",color:e.color},e.title,a.createElement(T.A,{name:"close",onClick:()=>function(e){l(s.filter((t=>t.id!==e.id))),_({remove:[e.id]})}(e)})))))),a.createElement("div",{className:"toolbar"},0===m.length?u:a.createElement(R.PopoverDropdownMenu,{onOpen:()=>c(!0),onClose:()=>c(!1),trigger:u,open:d,placement:"right-start"},a.createElement(ne.A,{size:"small",textAlign:"center"},a.createElement(o.Translate,null,"Add tags")),a.createElement(re.A,{style:{margin:0}}),a.createElement("div",{className:"events-registration-client-js-components-___RegistrationTagsEditableList-module__selectable-tags-container___pwRX2"},m.map((e=>a.createElement("div",{key:e.title,onClick:()=>function(e){const t=ie().sortBy([...s,e],[e=>e.title.toLowerCase()],"title");l(t),t.length===r.length&&c(!1),_({add:[e.id]})}(e)},a.createElement(ae.A,{className:"events-registration-client-js-components-___RegistrationTagsEditableList-module__registration-tag___nAtUC events-registration-client-js-components-___RegistrationTagsEditableList-module__selectable___2VM7u",color:e.color},e.title))))))))}le.propTypes={eventId:l().number.isRequired,regformId:l().number.isRequired,registrationId:l().number.isRequired,assignedTags:l().arrayOf(l().shape({title:l().string.isRequired,color:l().string.isRequired})).isRequired,allTags:l().arrayOf(l().shape({title:l().string.isRequired,color:l().string.isRequired})).isRequired};var oe=i(44515),de=i(88996),ce=i(24372),me=i(45967);const _e=e=>e.staticData,ue=e=>e.sections,ge=e=>e.items,pe=(0,me.Mz)(ge,((e,t)=>t),((e,t)=>e[t])),fe=(0,me.Mz)(_e,(e=>e.currency)),ye=(0,me.Mz)(fe,(e=>t=>new Intl.NumberFormat(document.documentElement.lang,{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(t))),ve=(0,me.Mz)(ue,(e=>ie().sortBy(Object.values(e).filter((e=>e.enabled)),["position","id"]))),be=(0,me.Mz)(ue,ge,((e,t)=>{const i=new Map(Object.values(e).map((e=>[e.id,[]])));return ie().sortBy(Object.values(t),["position","id"]).forEach((e=>{i.get(e.sectionId).push(e)})),i})),he=(0,me.Mz)(ve,be,((e,t)=>e.map((e=>({...e,items:t.get(e.id)}))))),Ee=(0,me.Mz)(ge,(e=>{const t=new Map;for(const i of Object.values(e))t.set(i.htmlName,{label:i.title,id:`input-${i.id}`});return t.set("captcha",{label:o.Translate.string("Captcha"),id:"input-captcha"}),t})),De=e=>e.uiLocked,Te=(0,me.Mz)(ue,(e=>ie().sortBy(Object.values(e).filter((e=>!e.enabled)),["position","id"]))),qe=(0,me.Mz)(ue,((e,t)=>t),((e,t)=>e[t])),Re=(0,me.Mz)(ge,((e,t)=>t),((e,t)=>e[t].sectionId)),we=(0,me.Mz)(pe,(e=>"label"===e.inputType)),xe=(0,me.Mz)(we,(e=>(t,i)=>e?t:i)),Ie=(0,me.Mz)(_e,(e=>{const{eventId:t,regformId:i}=e;return(e=null,a=null)=>{const n={event_id:t,reg_form_id:i};return null!==e&&(n.section_id=e),null!==a&&(n.field_id=a),n}})),Ae=(0,me.Mz)(_e,(e=>e.dataRetentionRange)),Ce=r.Ay.bind(null,{endpoint:"event_registration.add_field",rules:[{args:["event_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"fields",isDynamic:!1}]}]},"/"),Pe=r.Ay.bind(null,{endpoint:"event_registration.add_section",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1}]}]},"/"),Se=r.Ay.bind(null,{endpoint:"event_registration.add_text",rules:[{args:["event_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"text",isDynamic:!1}]}]},"/"),Ne=r.Ay.bind(null,{endpoint:"event_registration.modify_field",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"fields",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/"),ke=r.Ay.bind(null,{endpoint:"event_registration.modify_section",rules:[{args:["event_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0}]}]},"/"),Fe=r.Ay.bind(null,{endpoint:"event_registration.modify_text",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"text",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/"),Me=r.Ay.bind(null,{endpoint:"event_registration.move_field",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"fields",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"move",isDynamic:!1}]}]},"/"),Le=r.Ay.bind(null,{endpoint:"event_registration.move_section",rules:[{args:["event_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"move",isDynamic:!1}]}]},"/"),Oe=r.Ay.bind(null,{endpoint:"event_registration.move_text",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"text",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"move",isDynamic:!1}]}]},"/"),je=r.Ay.bind(null,{endpoint:"event_registration.toggle_field",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"fields",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"toggle",isDynamic:!1}]}]},"/"),Ue=r.Ay.bind(null,{endpoint:"event_registration.toggle_section",rules:[{args:["event_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"toggle",isDynamic:!1}]}]},"/"),ze=r.Ay.bind(null,{endpoint:"event_registration.toggle_text",rules:[{args:["event_id","field_id","reg_form_id","section_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"form",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sections",isDynamic:!1},{data:"/",isDynamic:!1},{data:"section_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"text",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"toggle",isDynamic:!1}]}]},"/"),Ye="Lock interface",$e="Unlock interface",Ve="Set form data",Be="Move section",He="Update section",Ze="Toggle section",Je="Remove section",Ge="Create section",Ke="Move item",We="Update item",Qe="Remove item",Xe="Create item",et="Update positions";function tt(e,...t){const i=(0,de.P$)(e,...t);return async e=>{e({type:Ye});const t=await i();return e({type:$e}),t}}function it(e){return{type:et,items:e.items,sections:e.sections}}function at(e,t){return{type:Be,sourceIndex:e,targetIndex:t}}function nt(e,t){return{type:Ze,sectionId:e,enabled:t}}function rt(e,t,i){return{type:Ke,sectionId:e,sourceIndex:t,targetIndex:i}}function st(e,t){return{type:We,itemId:e,data:t}}function lt(e){return async(t,i)=>{const a=i(),n=ke(Ie(a)(e)),r=await tt((()=>g.indicoAxios.delete(n)))(t);return r.error||t(function(e){return{type:Je,sectionId:e}}(e)),!!r.error}}function ot(e,t){return async(i,a)=>{const n=a(),r=ke(Ie(n)(e)),s={changes:t},l=await(0,de.HX)((()=>g.indicoAxios.patch(r,s)))(i);return l.error||(delete l.data.items,i(function(e,t,i=!1){return{type:He,sectionId:e,data:t,patch:i}}(e,l.data))),(0,ce.camelizeKeys)(l)}}function dt(e){return async(t,i)=>{const a=i(),n=Pe(Ie(a)()),r=await(0,de.HX)((()=>g.indicoAxios.post(n,e)))(t);return r.error||(delete r.data.items,t(function(e){return{type:Ge,data:e}}(r.data))),(0,ce.camelizeKeys)(r)}}function ct(e){return async(t,i)=>{const a=i(),n=Re(a,e),r=xe(a,e)(Fe,Ne)(Ie(a)(n,e)),s=await tt((()=>g.indicoAxios.delete(r)))(t);return s.error||t(function(e){return{type:Qe,itemId:e}}(e)),!!s.error}}function mt(e,t,i){return async(a,n)=>{const r=n(),s=("label"===t?Se:Ce)(Ie(r)(e)),l={fieldData:{...i,input_type:t}},o=await(0,de.HX)((()=>g.indicoAxios.post(s,l)))(a);return o.error||a(function(e){return{type:Xe,data:e}}(o.data.view_data)),(0,ce.camelizeKeys)(o)}}const _t={uiLocked:(e=!1,t)=>{switch(t.type){case Ye:return!0;case $e:return!1;default:return e}},items:(e={},t)=>{switch(t.type){case Ve:return t.items;case Xe:return{...e,[t.data.id]:t.data};case We:return{...e,[t.itemId]:t.data};case et:{const i={...e};return Object.entries(t.items).filter((([e])=>e in i)).forEach((([e,t])=>{i[e]={...i[e],position:t}})),i}case Qe:return ie().omit(e,t.itemId);case Je:return ie().omitBy(e,(e=>e.sectionId===t.sectionId));case Ke:{const i=ie().sortBy(Object.values(e).filter((e=>e.sectionId===t.sectionId)),["position","id"]),a=i[t.sourceIndex];i.splice(t.sourceIndex,1),i.splice(t.targetIndex,0,a);let n=1,r=1e3;const s={...e};return i.forEach((e=>{s[e.id]={...e,position:e.isEnabled?n++:r++}})),s}default:return e}},sections:(e={},t)=>{switch(t.type){case Ve:return t.sections;case Ze:return{...e,[t.sectionId]:{...e[t.sectionId],enabled:t.enabled}};case Ge:return{...e,[t.data.id]:t.data};case He:return{...e,[t.sectionId]:t.patch?{...e[t.sectionId],...t.data}:t.data};case et:{const i={...e};return Object.entries(t.sections).filter((([e])=>e in i)).forEach((([e,t])=>{i[e]={...i[e],position:t}})),i}case Je:return ie().omit(e,t.sectionId);case Be:{const i=ie().sortBy(Object.values(e),["position","id"]),a=i[t.sourceIndex];i.splice(t.sourceIndex,1),i.splice(t.targetIndex,0,a);let n=1,r=1e3;const s={...e};return i.forEach((e=>{s[e.id]={...e,position:e.enabled?n++:r++}})),s}default:return e}}};var ut=i(10531),gt=i(88467),pt=i(42430),ft=i(96446),yt=i(57427),vt=i(92117);const bt="events-registration-client-styles-___regform-module__field___mpG7J";function ht({id:e,title:t}){const i=(0,oe.useDispatch)(),[n,r]=(0,a.useState)(!1);return a.createElement(yt.A,null,a.createElement("span",null,t),a.createElement("div",{className:"events-registration-client-styles-___regform-module__actions___yuXgO"},a.createElement(P.A,{content:o.Translate.string("Restore"),trigger:a.createElement(T.A,{name:"undo",color:"grey",size:"small",onClick:()=>{var t;i((t=e,async(e,i)=>{const a=i(),n=Ie(a)(t),r=Ue({...n,enable:"true"}),s=await tt((()=>g.indicoAxios.post(r)))(e);s.error||(e(nt(t,!0)),e(it(s.data.positions)))}))},circular:!0,inverted:!0})}),a.createElement(P.A,{content:o.Translate.string("Delete"),trigger:a.createElement(T.A,{name:"trash",color:"red",size:"small",onClick:()=>{r(!0)},circular:!0,inverted:!0})})),a.createElement(R.RequestConfirmDelete,{requestFunc:()=>i(lt(e)),onClose:()=>r(!1),open:n,size:"mini",persistent:!0},a.createElement(o.Translate,null,'Are you sure you want to delete the section "',a.createElement(o.Param,{name:"field",value:t,wrapper:a.createElement("strong",null)}),'"?')))}function Et({onClose:e}){const t=(0,oe.useSelector)(Te);return(0,a.useEffect)((()=>{t.length||e()}),[e,t.length]),a.createElement(vt.A,{open:!0,closeIcon:!0,size:"mini",onClose:e},a.createElement(vt.A.Header,null,a.createElement(o.Translate,null,"Disabled sections")),a.createElement(vt.A.Content,null,a.createElement("div",{className:"events-registration-client-styles-___regform-module__disabled-sections___TthNB"},t.length?t.map((e=>a.createElement(ht,(0,q.A)({key:e.id},e)))):o.Translate.string("There are no disabled sections."))))}ht.propTypes={id:l().number.isRequired,title:l().string.isRequired},Et.propTypes={onClose:l().func.isRequired};var Dt=i(63173);function Tt({id:e,onClose:t}){const i=(0,oe.useDispatch)(),n=null!==e,{title:r,description:s,isPersonalData:l,isManagerOnly:d}=(0,oe.useSelector)((t=>n?qe(t,e):{}));return a.createElement(Dt.Sz,{id:"regform-section-settings",onSubmit:async a=>{const r=n?ot(e,a):dt(a),s=await i(r);if(s.error)return s.error;t()},onClose:t,initialValues:n?{title:r,description:s,is_manager_only:d}:null,header:n?a.createElement(o.Translate,null,'Configure section "',a.createElement(o.Param,{name:"section",value:r}),'"'):a.createElement(o.Translate,null,"Add new section")},a.createElement(_.FinalInput,{name:"title",label:o.Translate.string("Title"),required:!0,autoFocus:!0}),a.createElement(_.FinalTextArea,{name:"description",label:o.Translate.string("Description"),description:a.createElement(o.Translate,null,"You may use Markdown for formatting.")}),a.createElement(_.FinalCheckbox,{disabled:l,name:"is_manager_only",label:o.Translate.string("Manager-only"),description:a.createElement(o.Translate,null,"Whether the section is only visible for managers.")}))}Tt.propTypes={id:l().number,onClose:l().func.isRequired},Tt.defaultProps={id:null};var qt=i(6423),Rt=i(94900),wt=i(18606);(0,me.Mz)(_e,(e=>e.userInfo));const xt=(0,me.Mz)(_e,(e=>!!e.registrationUuid)),It=(0,me.Mz)(_e,(e=>e.registrationData)),At=(0,me.Mz)(_e,(e=>e.moderated)),Ct=(0,me.Mz)(_e,(e=>e.management||!1)),Pt=(0,me.Mz)(_e,(e=>e.paid||!1)),St=(0,me.Mz)(_e,(e=>e.publishToParticipants)),Nt=(0,me.Mz)(_e,(e=>e.publishToPublic)),kt=(0,me.Mz)(xt,It,((e,t)=>pe(e,t)),((e,t,i)=>e?t[i.htmlName]:void 0)),Ft=(0,me.Mz)(Pt,((e,t)=>pe(e,t)),((e,t)=>kt(e,t)),((e,t,i)=>{if(!e)return!1;if(t.price>0)return!0;if(void 0!==i&&t.choices){let e;return e="string"==typeof i?e=>e.id===i:i.choice?e=>e.id===i.choice:e=>i[e.id]>0,!!t.choices.find((t=>t.price>0&&e(t)))}return!1}));var Mt=i(14867),Lt=i.n(Mt),Ot=i(15106),jt=i(11052);function Ut({paid:e,management:t,choice:i}){let n=null,r=null;return i._deleted?n=a.createElement(o.Translate,null,"The currently chosen option is not available anymore. If you unselect it you won't be able to choose it back."):i._modified&&(n=i.price?a.createElement(o.Translate,null,"The currently chosen option has been modified. If you unselect it you may not be able to select it again for the same price."):a.createElement(o.Translate,null,"The currently chosen option has been modified. If you unselect it you may not be able to select it again.")),e&&!t?r=a.createElement(o.Translate,null,"This option could trigger a price change and has been blocked."):e&&(r=a.createElement(o.Translate,null,"Choosing this option will result in a price change.")),n||r?a.createElement(a.Fragment,null,i.caption," ",n&&a.createElement(P.A,{trigger:a.createElement(T.A,{name:"warning sign",color:"orange"})},n),n&&r&&" ",r&&a.createElement(P.A,{trigger:a.createElement(T.A,{name:"warning sign",color:"orange"})},r)):i.caption}Ut.propTypes={paid:l().bool.isRequired,management:l().bool.isRequired,choice:l().shape({caption:l().string.isRequired,price:l().number,_deleted:l().bool,_modified:l().bool}).isRequired};var zt=i(50090),Yt=i(30397),$t=i(51479);const Vt={"./ChoicesSetup.module.scss":{"choices-table-wrapper":"events-registration-client-js-form-fields-___ChoicesSetup-module__choices-table-wrapper___qY3fA","choices-table":"events-registration-client-js-form-fields-___ChoicesSetup-module__choices-table___w2Tu2","table-sortable-handle":"events-registration-client-js-form-fields-___ChoicesSetup-module__table-sortable-handle___D7vqk","empty-row":"events-registration-client-js-form-fields-___ChoicesSetup-module__empty-row___OpJWg","disabled-row":"events-registration-client-js-form-fields-___ChoicesSetup-module__disabled-row___fT9s2"}},Bt={id:l().string.isRequired,caption:l().string.isRequired,isEnabled:l().bool.isRequired,price:l().number.isRequired,placesLimit:l().number,maxExtraSlots:l().number};function Ht({onFocus:e,onBlur:t,onChange:i,disabled:n,value:r,withExtraSlots:s,forAccommodation:l}){const d=(0,oe.useSelector)(fe),c=e=>()=>i(r.filter((t=>t.id!==e))),m=(e,t)=>{const a=[...r],n=a[e];a.splice(e,1),a.splice(t,0,n),i(a)};return a.createElement(a.Fragment,null,a.createElement(ft.S,{className:"events-registration-client-js-form-fields-___ChoicesSetup-module__choices-table-wrapper___qY3fA",accept:"regform-item-choice"},a.createElement("table",{className:"events-registration-client-js-form-fields-___ChoicesSetup-module__choices-table___w2Tu2"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",{style:{width:"1.75em"}}),a.createElement("th",null,a.createElement(o.Translate,null,"Caption")),a.createElement("th",{style:{width:"7em"}},a.createElement(o.Translate,null,"Price (",a.createElement(o.Param,{name:"currency",value:d}),")")),a.createElement("th",{style:{width:"7em"}},a.createElement(o.Translate,null,"Limit")),s?a.createElement("th",{colSpan:"2"},a.createElement(o.Translate,null,"Max. extra slots")):a.createElement("th",{style:{width:"3.7em"}}))),a.createElement("tbody",null,r.map(((l,o)=>{return a.createElement(Jt,(0,q.A)({key:l.id,index:o,withExtraSlots:s,onChange:(d=l.id,(e,t)=>i(r.map((i=>i.id!==d?i:{...i,[e]:t})))),onDelete:c(l.id),onMove:m,fieldProps:{onFocus:e,onBlur:t,disabled:n}},l));var d}))))),l&&a.createElement("p",{className:"field-description",style:{textAlign:"end",marginTop:"-1em",marginBottom:"1em"}},a.createElement(o.Translate,null,"All prices are per night")),a.createElement(C.A,{type:"button",onClick:()=>{const e={id:`new:${(0,Yt.Ak)()}`,caption:"",isEnabled:!0,price:0,placesLimit:0};l||(e.maxExtraSlots=0),i([...r,e])},disabled:n},a.createElement(o.Translate,{context:"Choice"},"Add new")))}Ht.propTypes={onFocus:l().func.isRequired,onBlur:l().func.isRequired,onChange:l().func.isRequired,value:l().arrayOf(l().shape(Bt)).isRequired,disabled:l().bool.isRequired,withExtraSlots:l().bool,forAccommodation:l().bool},Ht.defaultProps={withExtraSlots:!1,forAccommodation:!1};const Zt=(0,zt.A)({field:"choices",updates:e=>({isPriceSet:e.some((e=>e.price))})});function Jt({withExtraSlots:e,fieldProps:t,index:i,id:n,caption:r,price:s,placesLimit:l,maxExtraSlots:d,extraSlotsPay:c,isEnabled:m,isNoAccommodation:_,onChange:u,onMove:g,onDelete:p}){const[f,y,v]=(0,ft.f)({type:"regform-item-choice",id:n,index:i,active:!t.disabled,separateHandle:!0,moveItem:g,onDrop:()=>null}),b=e=>t=>{const i=t.target;"checkbox"===i.type?u(e,i.checked):"number"===i.type?u(e,+i.value):u(e,i.value)};return a.createElement("tr",{ref:y,style:v,className:(0,O.A)(m?void 0:"disabled-row",Vt,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},a.createElement("td",{className:"events-registration-client-js-form-fields-___ChoicesSetup-module__table-sortable-handle___D7vqk",ref:f}),a.createElement("td",null,a.createElement("input",{type:"text",name:"caption",value:r,required:!0,onChange:b("caption"),placeholder:_?o.Translate.string("No accommodation"):void 0})),a.createElement("td",null,!_&&a.createElement("input",(0,q.A)({type:"number",name:"price",min:"0",step:"0.01",value:s||"",onChange:b("price")},t))),a.createElement("td",null,!_&&a.createElement("input",(0,q.A)({type:"number",name:"placesLimit",min:"0",value:l||"",onChange:b("placesLimit")},t))),!_&&e&&a.createElement("td",{style:{width:0}},a.createElement($t.A,(0,q.A)({type:"number",name:"maxExtraSlots",min:"0",value:d,onChange:b("maxExtraSlots"),icon:{name:"dollar",link:!0,color:c?"blue":"grey",title:o.Translate.string("Extra slots pay"),onClick:()=>u("extraSlotsPay",!c)},style:{width:"7.5em"}},t))),a.createElement("td",{style:{textAlign:"end"}},!_&&a.createElement("a",{className:"icon-remove remove-row",title:o.Translate.string("Remove row"),onClick:t.disabled?void 0:p}),m?a.createElement("a",{className:"icon-disable",title:o.Translate.string("Disable choice"),onClick:()=>u("isEnabled",!1)}):a.createElement("a",{className:"icon-checkmark remove-row",title:o.Translate.string("Enable choice"),onClick:()=>u("isEnabled",!0)})))}function Gt({placesLimit:e,placesUsed:t,isEnabled:i}){const n=e-t,r=n>0?i?"green":"grey":"red";return a.createElement(ae.A,{color:r,style:{whiteSpace:"nowrap"}},n>0?a.createElement(o.PluralTranslate,{count:n},a.createElement(o.Singular,null,a.createElement(o.Param,{name:"count",value:n})," place left"),a.createElement(o.Plural,null,a.createElement(o.Param,{name:"count",value:n})," places left")):a.createElement(o.Translate,null,"No places left"))}Jt.propTypes={withExtraSlots:l().bool.isRequired,fieldProps:l().object.isRequired,onChange:l().func.isRequired,onMove:l().func.isRequired,onDelete:l().func.isRequired,...Bt},Gt.propTypes={placesLimit:l().number.isRequired,placesUsed:l().number.isRequired,isEnabled:l().bool.isRequired};function Kt({id:e,existingValue:t,value:i,onChange:n,disabled:r,isPurged:s,choices:l,arrival:d,departure:c,placesUsed:m}){const _=(0,oe.useSelector)(Pt),u=(0,oe.useSelector)(Ct),g=(0,oe.useSelector)(ye),p=l.find((e=>e.id===i.choice)),f=i.arrivalDate&&i.departureDate?Lt()(i.departureDate).diff(Lt()(i.arrivalDate),"days"):0,y=e=>e.price>0&&_,v=e=>!u&&y(e);return a.createElement("div",{className:"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0"},a.createElement("table",{className:"events-registration-client-js-form-fields-___table-module__choice-table___nw5lF",role:"presentation",id:e},a.createElement("tbody",null,l.filter((e=>e.isEnabled||!e.isNoAccommodation)).map(((l,d)=>{return a.createElement("tr",{key:l.id,className:"events-registration-client-js-form-fields-___table-module__row___kh-Ns"},a.createElement("td",null,a.createElement(R.RadioButton,{id:e?`${e}-${d}`:"",name:e,key:l.id,value:l.id,checked:!s&&l.id===i.choice,disabled:!l.isEnabled||r||v(l)||l.placesLimit>0&&(m[l.id]||0)>=l.placesLimit&&l.id!==t.choice,label:a.createElement(Ut,{choice:l,management:u,paid:y(l)}),onChange:(c=l,()=>{const e={...i,choice:c.id,isNoAccommodation:c.isNoAccommodation};c.isNoAccommodation&&(delete e.arrivalDate,delete e.departureDate),n(e)})})),a.createElement("td",null,l.isEnabled&&!!l.price&&a.createElement(ae.A,{pointing:"left"},a.createElement(o.Translate,null,a.createElement(o.Param,{name:"price",value:g(l.price)})," per night"))),a.createElement("td",null,0===l.placesLimit?null:a.createElement(Gt,{placesLimit:l.placesLimit,placesUsed:m[l.id]||0,isEnabled:!r&&l.isEnabled&&!v(l)})));var c})))),null!==i.choice&&!i.isNoAccommodation&&a.createElement("div",{className:"events-registration-client-styles-___regform-module__date-picker___zVaWU"},a.createElement(R.DateRangePicker,{label:o.Translate.string("Pick the arrival and departure dates"),onChange:({startDate:e=null,endDate:t=null})=>{n({...i,arrivalDate:e,departureDate:t})},value:{startDate:i.arrivalDate||"",endDate:i.departureDate||""},rangeStartLabel:o.Translate.string("Arrival"),rangeEndLabel:o.Translate.string("Departure"),rangeStartMin:d.startDate,rangeStartMax:d.endDate,rangeEndMin:c.startDate,rangeEndMax:c.endDate}),!!p.price&&a.createElement(ae.A,{pointing:"left",className:"events-registration-client-styles-___regform-module__price-tag___pz3tt"},a.createElement(o.Translate,null,"Total:"," ",a.createElement(o.Param,{name:"price",value:g((f||0)*p.price)})))))}function Wt({fieldId:e,htmlId:t,htmlName:i,disabled:n,isRequired:r,isPurged:s,choices:l,arrival:d,departure:c,placesUsed:m}){const u=(0,oe.useSelector)((t=>kt(t,e)))||{choice:null};return a.createElement(_.FinalField,{id:t,name:i,existingValue:u,component:Kt,required:r,disabled:n,isPurged:s,choices:l,arrival:d,departure:c,placesUsed:m,validate:e=>null===e.choice?r?o.Translate.string("You must select an option"):void 0:e.isNoAccommodation||e.arrivalDate&&e.departureDate?void 0:o.Translate.string("You must select the arrival and departure date"),isEqual:ie().isEqual})}Kt.propTypes={id:l().string.isRequired,value:l().object.isRequired,onChange:l().func.isRequired,disabled:l().bool.isRequired,isPurged:l().bool.isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,arrival:l().shape({startDate:l().string.isRequired,endDate:l().string.isRequired}).isRequired,departure:l().shape({startDate:l().string.isRequired,endDate:l().string.isRequired}).isRequired,placesUsed:l().objectOf(l().number).isRequired,existingValue:l().shape({choice:l().string}).isRequired},Wt.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,isPurged:l().bool.isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,arrival:l().shape({startDate:l().string.isRequired,endDate:l().string.isRequired}).isRequired,departure:l().shape({startDate:l().string.isRequired,endDate:l().string.isRequired}).isRequired,placesUsed:l().objectOf(l().number).isRequired},Wt.defaultProps={disabled:!1,isRequired:!1};function Qt({value:e,header:t,onSubmit:i,onClose:n}){return a.createElement(Dt.Sz,{id:"accompanyingperson-form",onSubmit:i,onClose:n,initialValues:e,header:t},a.createElement(_.FinalInput,{name:"firstName",label:o.Translate.string("First Name"),required:!0,autoFocus:!0}),a.createElement(_.FinalInput,{name:"lastName",label:o.Translate.string("Last Name"),required:!0}))}function Xt(e,t,i,a,n){if(null===e)return t?[i,t]:[null,1/0];{const r=function(e,t){return Object.values(e).filter((e=>"accompanying_persons"===e.inputType&&e.personsCountAgainstLimit)).map((e=>e.htmlName)).reduce(((e,i)=>e+t.values[i]?.length||0),0)}(a,n);return!t||t>=e-r?[r,e]:[i,t]}}function ei({id:e,value:t,disabled:i,onChange:n,price:r,availablePlaces:s,maxPersons:l}){const[d,c]=(0,a.useState)({type:null,person:null}),m=(0,oe.useSelector)(ye),_=(t.length*r).toFixed(2),u=(0,oe.useSelector)(ge),g=(0,pt.useFormState)(),[p,f]=Xt(s,l,t.length,u,g),y=e=>{switch(e.type){case"ADD":return[...t,{id:`new:${(0,Yt.Ak)()}`,...e.person}];case"EDIT":return t.map((t=>t.id===e.person.id?e.person:t));case"REMOVE":return t.filter((t=>t.id!==e.id))}},v=()=>{c({type:null,person:null})};return a.createElement(qt.A.Group,{className:"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6"},a.createElement("ul",null,!t.length&&a.createElement("li",{className:"events-registration-client-styles-___regform-module__light___gdy5g"},a.createElement(o.Translate,null,"No accompanying persons registered")),t.map((e=>a.createElement("li",{key:e.id},a.createElement("span",null,e.firstName," ",e.lastName),a.createElement("div",{className:"events-registration-client-styles-___regform-module__actions___yuXgO"},a.createElement("a",{className:"icon-edit",title:o.Translate.string("Edit this person"),onClick:()=>{return i=e.id,void c({type:"EDIT",person:t.find((e=>e.id===i))});var i}}),a.createElement("a",{className:"icon-remove",title:o.Translate.string("Remove this person"),onClick:()=>{return t=e.id,void n(y({type:"REMOVE",id:t}));var t}})))))),a.createElement("div",{className:"events-registration-client-styles-___regform-module__summary___Krn7Y"},a.createElement(C.A,{size:"small",type:"button",onClick:()=>{c({type:"ADD",person:null})},disabled:i||f-p==0,"aria-describedby":e?`${e}-placeslimit`:""},a.createElement(o.Translate,null,"Add accompanying person")),!!r&&a.createElement(ae.A,{basic:!0,pointing:"left",className:"events-registration-client-styles-___regform-module__price-tag___pz3tt",size:"small"},m(r)," (Total: ",m(_),")"),f!==1/0&&a.createElement("div",{id:`${e}-placeslimit`,className:"events-registration-client-styles-___regform-module__places-left___6O4Ev"},a.createElement(Gt,{placesLimit:f,placesUsed:p,isEnabled:!i}))),["ADD","EDIT"].includes(d.type)&&a.createElement(Qt,{header:"EDIT"===d.type?o.Translate.string("Edit accompanying person"):o.Translate.string("Add accompanying person"),onSubmit:e=>{n(y({type:d.type,person:e})),v()},value:d.person,onClose:v}))}function ti({htmlId:e,htmlName:t,disabled:i,price:n,availablePlaces:r,maxPersons:s}){return a.createElement(_.FinalField,{id:e,name:t,component:ei,disabled:i,price:n,availablePlaces:r,maxPersons:s})}Qt.propTypes={value:l().shape({id:l().string.isRequired,firstName:l().string.isRequired,lastName:l().string.isRequired}),header:l().string.isRequired,onSubmit:l().func.isRequired,onClose:l().func.isRequired},Qt.defaultProps={value:{id:null,firstName:null,lastName:null}},ei.propTypes={id:l().string.isRequired,value:l().arrayOf(l().shape({id:l().string.isRequired,firstName:l().string.isRequired,lastName:l().string.isRequired})).isRequired,disabled:l().bool,onChange:l().func.isRequired,price:l().number,availablePlaces:l().number,maxPersons:l().number},ei.defaultProps={disabled:!1,price:0,availablePlaces:null,maxPersons:null},ti.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,price:l().number,availablePlaces:l().number,maxPersons:l().number},ti.defaultProps={disabled:!1,price:0,availablePlaces:null,maxPersons:null};const ii={"../../../styles/regform.module.scss":{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"},"./BooleanInput.module.scss":{"boolean-field":"events-registration-client-js-form-fields-___BooleanInput-module__boolean-field___7QLQW"}};function ai({id:e,fieldId:t,value:i,onChange:n,disabled:r,required:s,isPurged:l,price:d,placesLimit:c,placesUsed:m}){const _=(0,oe.useSelector)(ye),u=(0,oe.useSelector)((e=>kt(e,t))),g=e=>()=>n(e),p=e=>s?()=>{}:()=>{e===i&&n(null)},f=e=>{const t=p(e);return a=>{"Space"===a.code&&i===e&&(a.preventDefault(),t())}};return a.createElement("div",{className:"events-registration-client-js-form-fields-___BooleanInput-module__boolean-field___7QLQW"},a.createElement("label",null,a.createElement("input",{type:"radio",name:`boolean-field-${e}`,value:"yes",onChange:g(!0),onClick:p(!0),onKeyDown:f(!0),checked:!l&&!0===i,disabled:r||c>0&&m>=c&&!u,required:s}),a.createElement(o.Translate,{as:"span"},"Yes")),a.createElement("label",null,a.createElement("input",{type:"radio",name:`boolean-field-${e}`,value:"no",onChange:g(!1),onClick:p(!1),onKeyDown:f(!1),checked:!l&&!1===i,disabled:r,required:s}),a.createElement(o.Translate,{as:"span"},"No")),!!d&&a.createElement(ae.A,{pointing:"left",className:(0,O.A)("price-tag "+(!0!==i?"greyed":""),ii,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},_(d)),!!c&&a.createElement("div",{style:{marginLeft:"1em"}},a.createElement(Gt,{placesLimit:c,placesUsed:m,isEnabled:!r})))}function ni({fieldId:e,htmlId:t,htmlName:i,disabled:n,isRequired:r,isPurged:s,price:l,placesLimit:d,placesUsed:c}){return a.createElement(_.FinalField,{id:t,fieldId:e,name:i,component:ai,required:r?"no-validator":r,validate:e=>{if(r&&null===e)return o.Translate.string("This field is required.")},disabled:n,isPurged:s,allowNull:!0,price:l,placesLimit:d,placesUsed:c})}ai.propTypes={id:l().string.isRequired,fieldId:l().number.isRequired,value:l().bool,onChange:l().func.isRequired,disabled:l().bool.isRequired,required:l().bool.isRequired,isPurged:l().bool.isRequired,price:l().number.isRequired,placesLimit:l().number.isRequired,placesUsed:l().number.isRequired},ai.defaultProps={value:null},ni.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,isPurged:l().bool.isRequired,price:l().number,placesLimit:l().number,placesUsed:l().number},ni.defaultProps={disabled:!1,isRequired:!1,price:0,placesLimit:0,placesUsed:0};const ri={styles:{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"}};function si({fieldId:e,htmlId:t,htmlName:i,disabled:n,title:r,isRequired:s,showAsRequired:l,price:o,placesLimit:d,placesUsed:c,retentionPeriodIcon:m}){const u=(0,oe.useSelector)(ye),g=(0,oe.useSelector)((t=>kt(t,e)));return a.createElement(_.FinalCheckbox,{id:t,fieldProps:{className:`${bt} ${l?"required":""}`},name:i,label:r,disabled:n||d>0&&c>=d&&!g,required:s},m,!!o&&a.createElement(pt.Field,{name:i,subscription:{value:!0}},(({input:{value:e}})=>a.createElement(ae.A,{pointing:"left",className:(0,O.A)("price-tag "+(e?"":"greyed"),ri,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},u(o)))),!!d&&a.createElement("div",{style:{marginLeft:"1em",display:"inline-block"}},a.createElement(Gt,{placesLimit:d,placesUsed:c,isEnabled:!n})))}si.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,title:l().string.isRequired,isRequired:l().bool.isRequired,showAsRequired:l().bool.isRequired,price:l().number,placesLimit:l().number.isRequired,placesUsed:l().number.isRequired,retentionPeriodIcon:l().element},si.defaultProps={disabled:!1,price:0,retentionPeriodIcon:null};var li=i(59877);const oi=e=>String.fromCodePoint(...e.split("").map((e=>e.charCodeAt()+127397)));function di({value:e,onChange:t,choices:i,...n}){const[r,s,l]=(0,a.useMemo)((()=>{const e=[],t=new Map,a=new Map;return i.forEach((i=>{e.push([i.caption,`${oi(i.countryKey)} ${i.caption}`]),t.set(i.caption,i.countryKey),a.set(i.countryKey,i.caption)})),[e,t,a]}),[i]);return a.createElement(li.A,(0,q.A)({options:r,value:l.get(e)||e,onChange:e=>{t(s.get(e.target.value)||e.target.value)},"data-input-type":"country-dropdown"},n))}function ci({htmlId:e,htmlName:t,isRequired:i,choices:n,disabled:r}){return a.createElement(_.FinalField,{id:e,name:t,component:di,required:i,choices:n,clearable:!i,parse:e=>e,disabled:r})}function mi({htmlName:e}){const{hasPredefinedAffiliations:t}=(0,oe.useSelector)(_e);return"country"===e&&t?a.createElement(_.FinalCheckbox,{name:"useAffiliationCountry",label:o.Translate.string("Default to affiliation country")}):null}di.propTypes={value:l().string.isRequired,onChange:l().func.isRequired,choices:l().arrayOf(l().objectOf(l().string)).isRequired},ci.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,isRequired:l().bool,disabled:l().bool,choices:l().arrayOf(l().objectOf(l().string)).isRequired},ci.defaultProps={isRequired:!1,disabled:!1},mi.propTypes={htmlName:l().string},mi.defaultProps={htmlName:void 0};var _i=i(7305);function ui({id:e,value:t,onChange:i,onFocus:n,onBlur:r,disabled:s,required:l,dateFormat:o,timeFormat:d,minDate:c,maxDate:m}){const _=t.split("T")[0],u=t.includes("T")?t.split("T")[1]:"";return a.createElement(qt.A.Group,{className:"events-registration-client-styles-___regform-module__date-field___LToLh"},a.createElement(qt.A.Field,null,a.createElement(R.DatePicker,{id:e,name:"date",disabled:s,required:l,format:o,value:_,onChange:e=>{const t=e||"";i(t?`${t}T${d?u:"00:00:00"}`:"")},onFocus:n,onBlur:r,min:c,max:m})),d&&a.createElement(qt.A.Field,null,a.createElement(_i.A,{id:e,name:"time",disabled:s,required:l,showSecond:!1,value:(0,jt.toMoment)(u,"HH:mm:ss",!0),focusOnOpen:!0,onChange:e=>i(e?`${_}T${e.format("HH:mm:00")}`:_),use12Hours:"12h"===d,allowEmpty:!1,placeholder:"12h"===d?"--:-- am/pm":"--:--",getPopupContainer:e=>e})))}function gi({htmlId:e,htmlName:t,disabled:i,isRequired:n,dateFormat:r,timeFormat:s}){const l=r.replace(/%([HMdmY])/g,((e,t)=>({H:"HH",M:"mm",d:"DD",m:"MM",Y:"YYYY"}[t]))),d=e=>{if(e&&!e.match(/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:00(.*)/))return o.Translate.string("The provided date is invalid.")};if(r.includes("%d"))return a.createElement(_.FinalField,{id:e,name:t,component:ui,required:n,disabled:i,dateFormat:l,timeFormat:s,validate:d,parse:e=>e});{const s=e=>{if(!e)return e;const t={"%m/%Y":/^(?<month>\d{2})\/(?<year>\d{4})$/,"%m.%Y":/^(?<month>\d{2})\.(?<year>\d{4})$/,"%Y":/^(?<year>\d{4})$/}[r].exec(e),i=t?`${t.groups.year}-${t.groups.month??"01"}-01T00:00:00`:e;try{return(0,jt.toMoment)(i,"YYYY-MM-DDTHH:mm:ss",!0),i}catch(t){return e}},o=e=>{if(!e||!e.includes("T"))return e;try{return(0,jt.toMoment)(e,"YYYY-MM-DDTHH:mm:ss",!0).format(l)}catch(t){return e}};return a.createElement(_.FinalField,{id:e,type:"text",name:t,component:$t.A,required:n,disabled:i,placeholder:l,parse:s,format:o,validate:d})}}ui.propTypes={id:l().string.isRequired,value:l().string.isRequired,onChange:l().func.isRequired,onFocus:l().func.isRequired,onBlur:l().func.isRequired,disabled:l().bool.isRequired,required:l().bool.isRequired,dateFormat:l().oneOf(["DD/MM/YYYY","DD.MM.YYYY","MM/DD/YYYY","MM.DD.YYYY","YYYY/MM/DD","YYYY.MM.DD","MM/YYYY","MM.YYYY","YYYY"]).isRequired,timeFormat:l().oneOf(["12h","24h"]),minDate:l().string,maxDate:l().string},ui.defaultProps={timeFormat:null,minDate:void 0,maxDate:void 0},gi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,dateFormat:l().oneOf(["%d/%m/%Y","%d.%m.%Y","%m/%d/%Y","%m.%d.%Y","%Y/%m/%d","%Y.%m.%d","%m/%Y","%m.%Y","%Y"]).isRequired,timeFormat:l().oneOf(["12h","24h"])},gi.defaultProps={disabled:!1,isRequired:!1,timeFormat:null};const pi=(0,zt.A)({field:"dateFormat",updates:e=>e.includes("%d")?{}:{timeFormat:null}});const fi=r.Ay.bind(null,{endpoint:"event_registration.check_email",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"check-email",isDynamic:!1}]}]},"/"),yi=r.Ay.bind(null,{endpoint:"event_registration.check_email_management",rules:[{args:["event_id","reg_form_id"],converters:{event_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"check-email",isDynamic:!1}]}]},"/");function vi({htmlId:e,htmlName:t,disabled:i,isRequired:n}){const r="email"===t,[s,l]=(0,a.useState)({status:"",message:"",forEmail:""}),d=(0,oe.useSelector)(xt),{eventId:c,regformId:m,registrationUuid:p,management:f}=(0,oe.useSelector)(_e),[y,v]=(0,a.useMemo)((()=>{const e=new URLSearchParams(location.search);return[e.get("invitation"),e.get("form_token")]}),[]),b=(0,a.useMemo)((()=>{const e={event_id:c,reg_form_id:m};y&&(e.invitation=y),v&&(e.form_token=v);return(f?yi:fi)(e)}),[c,m,y,v,f]),h=(0,u.vJ)((async e=>{let t,i;if(!(e=e.trim()))return t=o.Translate.string("This field is required."),l({status:"error",forEmail:e,message:t}),t;l({status:"",forEmail:e,message:o.Translate.string("Checking email address...")});try{i=await g.indicoAxios.get(b,{params:d?{email:e,update:p}:{email:e}})}catch(e){return(0,g.handleAxiosError)(e)}const n=i.data,r=n.user?$("<span>",{text:n.user}).html():null;return t="email-already-registered"===n.conflict?o.Translate.string("There is already a registration with this email address."):"user-already-registered"===n.conflict?o.Translate.string("The user associated with this email address is already registered."):"no-user"===n.conflict?o.Translate.string("There is no Indico user associated with this email address."):"error"!==n.status||"email-other-user"!==n.conflict&&"email-no-user"!==n.conflict?"email-other-user"===n.conflict?a.createElement(o.Translate,null,"The registration will be re-associated to a different user (",a.createElement(o.Param,{name:"name",wrapper:a.createElement("strong",null),value:r}),")."):"email-no-user"===n.conflict?a.createElement(o.Translate,null,"The registration will be disassociated from the current user (",a.createElement(o.Param,{name:"name",wrapper:a.createElement("strong",null),value:r}),")."):"email-invalid"===n.conflict?"undeliverable"===n.email_error?o.Translate.string("The domain used in the email address does not exist."):o.Translate.string("This email address is invalid."):n.user?n.self?o.Translate.string("The registration will be associated with your Indico account."):n.same?a.createElement(o.Translate,null,"The registration will remain associated with the Indico account"," ",a.createElement(o.Param,{name:"name",wrapper:a.createElement("strong",null),value:r}),"."):a.createElement(o.Translate,null,"The registration will be associated with the Indico account"," ",a.createElement(o.Param,{name:"name",wrapper:a.createElement("strong",null),value:r}),"."):o.Translate.string("The registration will not be associated with any Indico account."):o.Translate.string("This email address is not associated with your Indico account."),l({status:n.status,message:t,forEmail:e}),"error"===n.status?t:void 0}),250);return a.createElement(_.FinalInput,{type:"email",id:e,name:t,required:n&&r?"no-validator":n,disabled:i,validate:r?h:n?_.validators.required:void 0,hideValidationError:!(!r||"error"!==s.status||!s.forEmail)&&"message",loaderWhileValidating:!0},r&&!!s.forEmail&&!!s.message&&a.createElement(k.A,{visible:!0,warning:"warning"===s.status,error:"error"===s.status,positive:"ok"===s.status},s.message))}vi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool.isRequired},vi.defaultProps={disabled:!1};const bi=r.Ay.bind(null,{endpoint:"event_registration.upload_file_management",rules:[{args:["event_id","field_id","reg_form_id"],converters:{event_id:"IntegerConverter",field_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"upload",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/"),hi=r.Ay.bind(null,{endpoint:"event_registration.upload_registration_file",rules:[{args:["event_id","field_id","reg_form_id"],converters:{event_id:"IntegerConverter",field_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"upload",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/");function Ei({fieldId:e,htmlId:t,htmlName:i,disabled:n,isRequired:r}){const{eventId:s,regformId:l,registrationUuid:o,fileData:d}=(0,oe.useSelector)(_e),c=(0,oe.useSelector)(xt),m=(0,oe.useSelector)(Ct),[_,u]=(0,a.useMemo)((()=>{const e=new URLSearchParams(location.search);return[e.get("invitation"),e.get("form_token")]}),[]),g=c&&d[i]||null,p={event_id:s,reg_form_id:l,field_id:e};return o&&(p.token=o),_&&(p.invitation=_),u&&(p.form_token=u),a.createElement("div",{className:"events-registration-client-styles-___regform-module__file-field___1Nup7",id:t},a.createElement(R.FinalSingleFileManager,{name:i,disabled:n,required:r,uploadURL:m?bi(p):hi(p),initialFileDetails:g}))}function Di({title:e}){return a.createElement("div",{className:"events-registration-client-styles-___regform-module__label___t11lD"},e)}Ei.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool},Ei.defaultProps={disabled:!1,isRequired:!1},Di.propTypes={title:l().string.isRequired};const Ti={"../../../styles/regform.module.scss":{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"},"./table.module.scss":{"choice-table":"events-registration-client-js-form-fields-___table-module__choice-table___nw5lF",dropdown:"events-registration-client-js-form-fields-___table-module__dropdown___EZd1Q",row:"events-registration-client-js-form-fields-___table-module__row___kh-Ns",checkbox:"events-registration-client-js-form-fields-___table-module__checkbox___7FyHh"}};function qi({id:e,existingValue:t,value:i,onChange:n,onFocus:r,onBlur:s,disabled:l,choices:d,withExtraSlots:c,placesUsed:m}){const _=(0,oe.useSelector)(Pt),u=(0,oe.useSelector)(Ct),g=(0,oe.useSelector)(ye),p=()=>{r(),s()},f=e=>()=>{p(),i[e.id]?n(ie().omit(i,e.id)):n({...i,[e.id]:1})},y=e=>t=>{p();const a=Number(t.target.value);n(a?{...i,[e.id]:a}:ie().omit(i,e.id))},v=(e,t=!1)=>{if(!t)return g(e.price);const a=i[e.id]||0;return g((0===a?0:e.extraSlotsPay?a:1)*e.price)},b=e=>e.price>0&&_,h=e=>!u&&b(e);return a.createElement("table",{className:"events-registration-client-js-form-fields-___table-module__choice-table___nw5lF",role:"presentation",id:e},a.createElement("tbody",null,d.map(((n,r)=>a.createElement("tr",{key:n.id,className:"events-registration-client-js-form-fields-___table-module__row___kh-Ns"},a.createElement("td",null,a.createElement(R.Checkbox,{id:e?`${e}-${r}`:"",value:n.id,disabled:!n.isEnabled||l||h(n)||n.placesLimit>0&&(m[n.id]||0)>=n.placesLimit&&!t[n.id],checked:!!i[n.id],onChange:f(n),label:a.createElement(Ut,{choice:n,management:u,paid:b(n)})})),a.createElement("td",null,n.isEnabled&&!!n.price&&a.createElement(ae.A,{pointing:"left",className:(0,O.A)(i[n.id]?"":"greyed",Ti,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},v(n))),a.createElement("td",null,0===n.placesLimit?null:a.createElement(Gt,{placesLimit:n.placesLimit,placesUsed:m[n.id]||0,isEnabled:!l&&n.isEnabled&&!h(n)})),c&&a.createElement("td",null,n.isEnabled&&a.createElement(R.Select,{selection:!0,className:"events-registration-client-js-form-fields-___table-module__dropdown___EZd1Q",disabled:l||h(n)||n.placesLimit>0&&(m[n.id]||0)-(t[n.id]||0)>=n.placesLimit,value:String(i[n.id]||0),onChange:y(n),options:ie().range(0,n.maxExtraSlots+2).map((e=>({value:e,disabled:n.placesLimit>0&&(m[n.id]||0)-(t[n.id]||0)+e>n.placesLimit}))),required:!0})),c&&a.createElement("td",null,n.isEnabled&&!!n.price&&!!i[n.id]&&a.createElement(ae.A,{pointing:"left"},a.createElement(o.Translate,null,"Total: ",a.createElement(o.Param,{name:"price",value:v(n,!0)})))))))))}function Ri({fieldId:e,htmlId:t,htmlName:i,disabled:n,isRequired:r,choices:s,maxChoices:l,withExtraSlots:d,placesUsed:c}){const m=(0,oe.useSelector)((t=>kt(t,e)))||{};return a.createElement(_.FinalField,{id:t,name:i,component:qi,required:!!r&&"no-validator",disabled:n,choices:s,withExtraSlots:d,placesUsed:c,existingValue:m,isEqual:ie().isEqual,validate:e=>r&&!ie().keys(e).length?o.Translate.string("This field is required"):l&&ie().keys(e).length>l?o.PluralTranslate.string("At most {n} option can be selected","At most {n} options can be selected",l,{n:l}):void 0})}qi.propTypes={id:l().string.isRequired,value:l().object.isRequired,onChange:l().func.isRequired,onFocus:l().func.isRequired,onBlur:l().func.isRequired,disabled:l().bool.isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,withExtraSlots:l().bool.isRequired,placesUsed:l().objectOf(l().number).isRequired,existingValue:l().objectOf(l().number).isRequired},Ri.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,choices:l().arrayOf(l().shape(Bt)).isRequired,maxChoices:l().number,withExtraSlots:l().bool,placesUsed:l().objectOf(l().number).isRequired},Ri.defaultProps={disabled:!1,isRequired:!1,maxChoices:null,withExtraSlots:!1};function wi({id:e,value:t,onChange:i,disabled:n,price:r,minValue:s,maxValue:l}){const o=(0,oe.useSelector)(ye),d=(t*r).toFixed(2);return a.createElement("div",{className:"events-registration-client-styles-___regform-module__number-field___LtuaG"},a.createElement("input",{id:e,type:"number",value:null!==t?t:"",min:s,max:l||void 0,disabled:n,onChange:e=>i(e.target.value?+e.target.value:null)}),!!r&&a.createElement(ae.A,{pointing:"left",className:"events-registration-client-styles-___regform-module__price-tag___pz3tt"},o(r)," (Total: ",o(d),")"))}function xi({htmlId:e,htmlName:t,disabled:i,isRequired:n,price:r,minValue:s,maxValue:l}){const o=n?_.validators.chain(_.validators.required,_.validators.number(),_.validators.range(s,l||1/0)):_.validators.chain(_.validators.optional(),_.validators.number(),_.validators.range(s,l||1/0));return a.createElement(_.FinalField,{id:e,name:t,component:wi,required:n,disabled:i,allowNull:!0,price:r,minValue:s,maxValue:l,parse:_.parsers.number,validate:o})}function Ii({htmlId:e,htmlName:t,isRequired:i,disabled:n}){return a.createElement(_.FinalInput,{id:e,type:"tel",name:t,required:i,disabled:n})}wi.propTypes={id:l().string.isRequired,value:l().number,onChange:l().func.isRequired,disabled:l().bool.isRequired,price:l().number.isRequired,minValue:l().number.isRequired,maxValue:l().number},wi.defaultProps={value:null,maxValue:null},xi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,price:l().number,minValue:l().number,maxValue:l().number},xi.defaultProps={disabled:!1,isRequired:!1,price:0,minValue:0,maxValue:0},Ii.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,isRequired:l().bool.isRequired,disabled:l().bool},Ii.defaultProps={disabled:!1};const Ai=r.Ay.bind(null,{endpoint:"event_registration.manage_registration_file",rules:[{args:["event_id","field_data_id","filename","reg_form_id","registration_id"],converters:{event_id:"IntegerConverter",field_data_id:"IntegerConverter",reg_form_id:"IntegerConverter",registration_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_data_id",isDynamic:!0},{data:"-",isDynamic:!1},{data:"filename",isDynamic:!0}]}]},"/"),Ci=r.Ay.bind(null,{endpoint:"event_registration.registration_picture",rules:[{args:["event_id","field_data_id","filename","reg_form_id","registration_id"],converters:{event_id:"IntegerConverter",field_data_id:"IntegerConverter",reg_form_id:"IntegerConverter",registration_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registration_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"picture",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_data_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"filename",isDynamic:!0}]}]},"/"),Pi=r.Ay.bind(null,{endpoint:"event_registration.upload_picture_management",rules:[{args:["event_id","field_id","reg_form_id"],converters:{event_id:"IntegerConverter",field_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"upload-picture",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/"),Si=r.Ay.bind(null,{endpoint:"event_registration.upload_registration_picture",rules:[{args:["event_id","field_id","reg_form_id"],converters:{event_id:"IntegerConverter",field_id:"IntegerConverter",reg_form_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"registrations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"reg_form_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"upload-picture",isDynamic:!1},{data:"/",isDynamic:!1},{data:"field_id",isDynamic:!0}]}]},"/");function Ni({fieldId:e,htmlName:t,htmlId:i,disabled:n,isRequired:r,minPictureSize:s}){const{eventId:l,regformId:o,registrationUuid:d,fileData:c}=(0,oe.useSelector)(_e),m=c&&c[t]||null,_=(0,oe.useSelector)(Ct),[u,g]=(0,a.useMemo)((()=>{const e=new URLSearchParams(location.search);return[e.get("invitation"),e.get("form_token")]}),[]),p=_?Ai:Ci,f=_?Pi:Si,y={event_id:l,reg_form_id:o,field_id:e};d&&(y.token=d),u&&(y.invitation=u),g&&(y.form_token=g);const v=m?m.locator:null;return a.createElement("div",{className:"events-registration-client-styles-___regform-module__file-field___1Nup7",id:i},a.createElement(R.FinalPictureManager,{name:t,disabled:n,required:r,uploadURL:f(y),previewURL:v?p(v):"",initialPictureDetails:m,minPictureSize:s}))}Ni.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,minPictureSize:l().number},Ni.defaultProps={disabled:!1,isRequired:!1,minPictureSize:null};const ki={"../../../styles/regform.module.scss":{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"},"./table.module.scss":{"choice-table":"events-registration-client-js-form-fields-___table-module__choice-table___nw5lF",dropdown:"events-registration-client-js-form-fields-___table-module__dropdown___EZd1Q",row:"events-registration-client-js-form-fields-___table-module__row___kh-Ns",checkbox:"events-registration-client-js-form-fields-___table-module__checkbox___7FyHh"}};function Fi({id:e,existingValue:t,value:i,onChange:n,onFocus:r,onBlur:s,disabled:l,isRequired:d,isPurged:c,choices:m,withExtraSlots:_,placesUsed:u}){const g=(0,oe.useSelector)(Pt),p=(0,oe.useSelector)(Ct),f=(0,oe.useSelector)(ye),y=m.find((e=>e.id in i))||{},v=i[y.id]||0,b=e=>e.price>0&&g,h=e=>!p&&b(e);let E=null;const D=`${e}-label`,T=_&&y&&y.maxExtraSlots>0,w=T&&!!y.price;if(T){const i=ie().range(1,y.maxExtraSlots+2).map((e=>({value:e,disabled:y.placesLimit>0&&(u[y.id]||0)-(t[y.id]||0)+e>y.placesLimit}))),r={};w&&(r["aria-describedby"]=D),E=a.createElement(R.Select,(0,q.A)({id:e?`${e}-extraslots`:"",options:i,disabled:l||h(y)||y.placesLimit>0&&(u[y.id]||0)-(t[y.id]||0)>=y.placesLimit,value:String(v),onChange:e=>{const t=Number(e.target.value);n({[y.id]:t})},"aria-label":o.Translate.string("Select extra slots"),required:!0},r))}const x=m.map((e=>({value:e.id,label:a.createElement("div",{className:"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",key:e.id},a.createElement("div",{className:"events-registration-client-styles-___regform-module__caption___u54ZN","data-label":!0},a.createElement(Ut,{choice:e,management:p,paid:b(e)})),a.createElement("div",{className:"events-registration-client-styles-___regform-module__labels___Zy8f7"},!!e.price&&a.createElement(ae.A,null,f(e.price)),0===e.placesLimit?null:a.createElement(Gt,{placesLimit:e.placesLimit,placesUsed:u[e.id]||0,isEnabled:e.isEnabled}))),disabled:!e.isEnabled||h(e)||e.placesLimit>0&&(u[e.id]||0)>=e.placesLimit&&!t[e.id]})));return a.createElement(qt.A.Group,{className:"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5"},a.createElement(qt.A.Field,null,a.createElement(R.Select,{id:e,onChange:e=>{e.target.value?n({[e.target.value]:1}):n({})},options:x,value:!c&&y.id||"",required:d,disabled:l,onFocus:r,onBlur:s})),a.createElement("div",{className:"events-registration-client-styles-___regform-module__extra-slots___5sb-R"},E,w&&a.createElement(ae.A,{pointing:"left",id:D},a.createElement(o.Translate,null,"Total:"," ",a.createElement(o.Param,{name:"price",value:f((y.extraSlotsPay?v:1)*y.price)})))))}function Mi({id:e,existingValue:t,value:i,onChange:n,disabled:r,isRequired:s,isPurged:l,choices:d,withExtraSlots:c,placesUsed:m}){const _=(0,oe.useSelector)(Pt),u=(0,oe.useSelector)(Ct),g=(0,oe.useSelector)(ye),p=d.find((e=>e.id in i))||{id:""},f=i[p.id]||0,y=[...d];s||y.unshift({id:"",isEnabled:!0,caption:o.Translate.string("None","Choice")});const v=e=>e.id===p.id,b=e=>e.price>0&&_,h=e=>!u&&b(e);return a.createElement("table",{className:"events-registration-client-js-form-fields-___table-module__choice-table___nw5lF",role:"presentation"},a.createElement("tbody",null,y.map(((i,s)=>a.createElement("tr",{key:i.id,className:"events-registration-client-js-form-fields-___table-module__row___kh-Ns"},a.createElement("td",null,a.createElement(R.RadioButton,{id:e?`${e}-${s}`:"",name:e,label:a.createElement(Ut,{choice:i,management:u,paid:b(i)}),key:i.id,value:i.id,disabled:!i.isEnabled||r||h(i)||i.placesLimit>0&&(m[i.id]||0)-(t[i.id]||0)>=i.placesLimit,checked:!l&&v(i),onChange:()=>{return e=i.id,void n(""===e?{}:{[e]:1});var e}})),a.createElement("td",null,i.isEnabled&&!!i.price&&a.createElement(ae.A,{pointing:"left",className:(0,O.A)(l||!v(i)?"greyed":"",ki,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},g(i.price))),a.createElement("td",null,""!==i.id&&0!==i.placesLimit&&a.createElement(Gt,{placesLimit:i.placesLimit,placesUsed:m[i.id]||0,isEnabled:!r&&i.isEnabled&&!h(i)})),c&&!!i.maxExtraSlots&&p.id===i.id&&a.createElement(a.Fragment,null,a.createElement("td",null,i.isEnabled&&a.createElement(R.Select,{id:e?`${e}-extraslot`:"",selection:!0,className:"events-registration-client-js-form-fields-___table-module__dropdown___EZd1Q",disabled:r||h(i)||i.placesLimit>0&&(m[i.id]||0)-(t[i.id]||0)>=i.placesLimit,value:String(f),onChange:e=>n({[p.id]:e.target.value}),options:ie().range(1,i.maxExtraSlots+2).map((e=>({value:e,disabled:p.placesLimit>0&&(m[p.id]||0)-(t[p.id]||0)+e>p.placesLimit}))),required:!0})),a.createElement("td",null,i.isEnabled&&!!i.price&&a.createElement(ae.A,{pointing:"left"},a.createElement(o.Translate,null,"Total:"," ",a.createElement(o.Param,{name:"price",value:g((p.extraSlotsPay?f:1)*i.price)}))))))))))}function Li({id:e,existingValue:t,value:i,onChange:n,onFocus:r,onBlur:s,disabled:l,isRequired:o,isPurged:d,itemType:c,choices:m,withExtraSlots:_,placesUsed:u}){let g=null;if("dropdown"===c)g=a.createElement(Fi,{id:e,value:i,existingValue:t,onChange:n,onFocus:r,onBlur:s,disabled:l,isRequired:o,isPurged:d,choices:m,withExtraSlots:_,placesUsed:u});else{if("radiogroup"!==c)return`ERROR: Unknown type ${c}`;g=a.createElement(Mi,{id:e,value:i,existingValue:t,onChange:n,disabled:l,isRequired:o,isPurged:d,choices:m,withExtraSlots:_,placesUsed:u})}return g}function Oi({fieldId:e,htmlId:t,htmlName:i,disabled:n,isRequired:r,isPurged:s,itemType:l,choices:d,withExtraSlots:c,placesUsed:m}){const u=(0,oe.useSelector)((t=>kt(t,e)))||{};return a.createElement(_.FinalField,{id:t,name:i,component:Li,format:e=>e||{},required:r,isRequired:r,validate:function(e){const t=!e||!Object.keys(e).length;if(r&&t)return o.Translate.string("This field is required")},disabled:n,isPurged:s,itemType:l,choices:d,withExtraSlots:c,placesUsed:m,existingValue:u,isEqual:ie().isEqual})}Fi.propTypes={id:l().string.isRequired,value:l().object.isRequired,onChange:l().func.isRequired,onFocus:l().func.isRequired,onBlur:l().func.isRequired,disabled:l().bool.isRequired,isRequired:l().bool.isRequired,isPurged:l().bool.isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,withExtraSlots:l().bool.isRequired,placesUsed:l().objectOf(l().number).isRequired,existingValue:l().objectOf(l().number).isRequired},Mi.propTypes={id:l().string.isRequired,value:l().object.isRequired,onChange:l().func.isRequired,disabled:l().bool.isRequired,isRequired:l().bool.isRequired,isPurged:l().bool.isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,withExtraSlots:l().bool.isRequired,placesUsed:l().objectOf(l().number).isRequired,existingValue:l().objectOf(l().number).isRequired},Li.propTypes={id:l().string.isRequired,disabled:l().bool.isRequired,isRequired:l().bool.isRequired,isPurged:l().bool.isRequired,itemType:l().oneOf(["dropdown","radiogroup"]).isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,withExtraSlots:l().bool.isRequired,placesUsed:l().objectOf(l().number).isRequired,existingValue:l().objectOf(l().number).isRequired},Oi.propTypes={fieldId:l().number.isRequired,htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,isRequired:l().bool,isPurged:l().bool.isRequired,itemType:l().oneOf(["dropdown","radiogroup"]).isRequired,choices:l().arrayOf(l().shape(Bt)).isRequired,withExtraSlots:l().bool,placesUsed:l().objectOf(l().number).isRequired},Oi.defaultProps={disabled:!1,isRequired:!1,withExtraSlots:!1};const ji=(0,zt.A)({field:"choices",updates:(e,t,{defaultItem:i})=>e.some((e=>e.id===i&&e.isEnabled))?{}:{defaultItem:null}});function Ui(e,t,i){const a={};return Object.entries(t).forEach((([t,n])=>{const r=e[t];null===r&&t in i?a[n]=i[t]:r>0&&(a[n]=r)})),a}const zi={numberOfRows:"rows"};function Yi({htmlId:e,htmlName:t,disabled:i,title:n,isRequired:r,...s}){const l=Ui(s,zi,Yi.defaultProps);return a.createElement(_.FinalTextArea,(0,q.A)({id:e,name:t},l,{disabled:i,required:r,style:{resize:"none"}}))}Yi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,numberOfRows:l().number,title:l().string.isRequired,isRequired:l().bool.isRequired},Yi.defaultProps={disabled:!1,numberOfRows:2};const $i={minLength:"minLength",maxLength:"maxLength"};function Vi({htmlId:e,htmlName:t,disabled:i,title:n,isRequired:r,...s}){const l=Ui(s,$i,Vi.defaultProps);return a.createElement(_.FinalInput,(0,q.A)({id:e,type:"text",name:t},l,{required:r,disabled:i}))}Vi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,disabled:l().bool,title:l().string.isRequired,isRequired:l().bool.isRequired,minLength:l().number,maxLength:l().number},Vi.defaultProps={disabled:!1,minLength:0,maxLength:0};const Bi=r.Ay.bind(null,{endpoint:"event_registration.api_session_blocks",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"registration",isDynamic:!1},{data:"/",isDynamic:!1},{data:"session-blocks",isDynamic:!1}]}]},"/"),Hi=l().arrayOf(l().shape({id:l().number.isRequired,fullTitle:l().string.isRequired,time:l().string.isRequired}));function Zi({value:e,name:t,sessionData:i,onChange:n,onFocus:r,onBlur:s,collapseDays:l,minimum:o,maximum:d,...c}){const[m,_]=(0,a.useState)({});(0,a.useEffect)((()=>{_(Object.fromEntries(Object.keys(i||{}).map((e=>[e,!l]))))}),[i,l]);const u=(0,a.useMemo)((()=>i?new Set(Object.values(i).flat().map((e=>e.id))):[]),[i]),g=e=>{n(e.filter((e=>u.has(e))))},p=t=>{r(),s();const i=Number(t.target.value),a=ie().xor(e,[i]);g(a)},f=e=>t=>{t.target.closest("label")||_({...m,[e]:!m[e]})};return a.createElement(qt.A.Group,{className:"events-registration-client-js-form-fields-___TimetableSessions-module__timetablesessions-field___PPVrg"},a.createElement(M.A,{styled:!0,exclusive:!1},i&&Object.keys(i).map(((n,r)=>a.createElement(Ji,{value:e,index:r,name:t,data:i[n],label:Lt()(n).format("dddd ll"),isExpanded:m[n]??!1,key:n,handleValueChange:p,onChange:g,onClick:f(n),props:c})))))}function Ji({value:e,index:t,data:i,label:n,isExpanded:r,handleValueChange:s,onChange:l,onClick:d}){const c=i.map((e=>e.id)),m=c.every((t=>e.includes(t))),_=c.some((t=>e.includes(t))),u=e.filter((e=>c.includes(e))).length;return a.createElement(a.Fragment,null,a.createElement(S.A,{className:"events-registration-client-js-form-fields-___TimetableSessions-module__accordion-title___vzXak",active:r,index:t,onClick:d},a.createElement(T.A,{name:"dropdown"}),a.createElement(R.Checkbox,{className:"events-registration-client-js-form-fields-___TimetableSessions-module__accordion-title-checkbox___LcTZ6",checked:m,onChange:function(t){t.stopPropagation();const i=m||_?e.filter((e=>!c.includes(e))):[...e,...c];l(i)},indeterminate:_&&!m,label:n}),a.createElement("span",{className:"events-registration-client-js-form-fields-___TimetableSessions-module__selection-count___C2Bfi"},"(",a.createElement(o.PluralTranslate,{count:u},a.createElement(o.Singular,null,a.createElement(o.Param,{name:"selectedBlocks",value:u})," block selected)"),a.createElement(o.Plural,null,a.createElement(o.Param,{name:"selectedBlocks",value:u})," blocks selected)")))),a.createElement(N.A,{as:"ul",active:r},i.map((({time:t,fullTitle:i,id:n})=>a.createElement("li",{className:"grouped-fields events-registration-client-js-form-fields-___TimetableSessions-module__session-block___UeLIT",key:n},a.createElement(R.Checkbox,{value:n,onChange:s,checked:e.includes(n),label:`${t} - ${i}`}))))))}function Gi({htmlId:e,htmlName:t,disabled:i,isRequired:n,collapseDays:r,minimum:s,maximum:l}){const{eventId:d}=(0,oe.useSelector)(_e),c=(0,oe.useSelector)(Ct),{data:m}=(0,u.Ku)({url:Bi({event_id:d,force_event_tz:c})},{camelize:!0}),g=o.PluralTranslate.string("Please select at least {minimum} session block","Please select at least {minimum} session blocks",s,{minimum:s}),p=o.PluralTranslate.string("Please select no more than {maximum} session block","Please select no more than {maximum} session blocks",l,{maximum:l});return a.createElement(_.FinalField,{id:e,name:t,component:Zi,disabled:i,required:n,collapseDays:r,minimum:s,maximum:l,sessionData:m,validate:e=>0!==s&&e.length<s?g:0!==l&&e.length>l?p:void 0})}Zi.propTypes={value:l().arrayOf(l().number).isRequired,name:l().string.isRequired,sessionData:l().objectOf(Hi),onChange:l().func.isRequired,onFocus:l().func.isRequired,onBlur:l().func.isRequired,collapseDays:l().bool.isRequired,maximum:l().number.isRequired,minimum:l().number.isRequired},Zi.defaultProps={sessionData:{}},Ji.propTypes={value:l().arrayOf(l().number).isRequired,index:l().number.isRequired,data:Hi.isRequired,label:l().string.isRequired,isExpanded:l().bool.isRequired,handleValueChange:l().func.isRequired,onChange:l().func.isRequired,onClick:l().func.isRequired},Gi.propTypes={htmlId:l().string.isRequired,htmlName:l().string.isRequired,isRequired:l().bool.isRequired,disabled:l().bool,collapseDays:l().bool,minimum:l().number,maximum:l().number},Gi.defaultProps={disabled:!1,collapseDays:!1,minimum:0,maximum:0};const Ki={label:{title:o.Translate.string("Label","Classification"),inputComponent:Di,noRequired:!0,noRetentionPeriod:!0,noLabel:!0,icon:"tag",customFormItem:!0},text:{title:o.Translate.string("Text field"),inputComponent:Vi,settingsComponent:function(){return a.createElement(qt.A.Group,{widths:"equal"},a.createElement(_.FinalInput,{name:"minLength",type:"number",label:o.Translate.string("Min. length"),placeholder:String(Vi.defaultProps.minLength),step:"1",min:"0",validate:_.validators.optional(_.validators.chain((e=>0===e?_.validators.STOP_VALIDATION:1===e?o.Translate.string('If you want to make the field required, select the "Required field" checkbox. The minimum length only applies if the field is not empty.'):void 0),_.validators.min(2))),format:e=>e||"",parse:e=>+e||0,fluid:!0}),a.createElement(_.FinalInput,{name:"maxLength",type:"number",label:o.Translate.string("Max. length"),placeholder:o.Translate.string("No maximum"),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),format:e=>e||"",parse:e=>+e||0,fluid:!0}))},settingsFormValidator:function({minLength:e,maxLength:t}){if(e&&t&&e>t){const e=o.Translate.string("The minimum length cannot be greater than the maximum length.");return{minLength:e,maxLength:e}}},icon:"textfield"},textarea:{title:o.Translate.string("Text area"),inputComponent:Yi,settingsComponent:function(){return a.createElement(qt.A.Group,{widths:"equal"},a.createElement(_.FinalInput,{name:"numberOfRows",type:"number",label:o.Translate.string("Rows"),placeholder:String(Yi.defaultProps.numberOfRows),step:"1",min:"1",max:"20",validate:_.validators.optional(_.validators.range(1,20)),fluid:!0}))},icon:"textarea"},number:{title:o.Translate.string("Number"),inputComponent:xi,settingsComponent:function(){return a.createElement(qt.A.Group,{widths:"equal"},a.createElement(_.FinalInput,{name:"minValue",type:"number",label:o.Translate.string("Minimum"),placeholder:String(xi.defaultProps.minValue),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),format:e=>e||"",parse:e=>+e||0,fluid:!0}),a.createElement(_.FinalInput,{name:"maxValue",type:"number",label:o.Translate.string("Maximum"),placeholder:o.Translate.string("No maximum"),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),format:e=>e||"",parse:e=>+e||0,fluid:!0}))},settingsFormValidator:function({minValue:e,maxValue:t}){if(e&&t&&e>t){const e=o.Translate.string("The minimum value cannot be greater than the maximum value.");return{minValue:e,maxValue:e}}},hasPrice:!0,icon:"seven-segment9"},checkbox:{title:o.Translate.string("Checkbox"),inputComponent:si,settingsComponent:function(){return a.createElement(_.FinalInput,{name:"placesLimit",type:"number",label:o.Translate.string("Places limit"),placeholder:o.Translate.string("None","Places limit"),step:"1",min:"1",validate:_.validators.optional(_.validators.min(0)),parse:e=>""===e?0:+e,format:e=>0===e?"":e})},noLabel:!0,hasPrice:!0,icon:"checkbox-checked",customFormItem:!0},date:{title:o.Translate.string("Date"),inputComponent:gi,settingsComponent:function(){const e=["%d/%m/%Y","%d.%m.%Y","%m/%d/%Y","%m.%d.%Y","%Y/%m/%d","%Y.%m.%d","%m/%Y","%m.%Y","%Y"].map((e=>({key:e,value:e,text:e.replace(/%([HMdmY])/g,((e,t)=>({H:"hh",M:"mm",d:"DD",m:"MM",Y:"YYYY"}[t])))}))),t=[{key:"12h",value:"12h",text:o.Translate.string("12 hours")},{key:"24h",value:"24h",text:o.Translate.string("24 hours")}];return a.createElement(qt.A.Group,{widths:"equal"},a.createElement(_.FinalDropdown,{name:"dateFormat",label:o.Translate.string("Date format"),options:e,required:!0,selection:!0,fluid:!0}),a.createElement(pt.Field,{name:"dateFormat",subscription:{value:!0}},(({input:{value:e}})=>a.createElement(_.FinalDropdown,{name:"timeFormat",label:o.Translate.string("Time format"),options:t,placeholder:o.Translate.string("None","Time format"),disabled:!e.includes("%d"),parse:_.parsers.nullIfEmpty,selection:!0,fluid:!0}))))},settingsFormDecorators:[pi],settingsFormInitialData:{dateFormat:"%d/%m/%Y",timeFormat:null},icon:"calendar"},bool:{title:o.Translate.string("Yes/No"),inputComponent:ni,settingsComponent:function(){const e=[{key:!0,value:!0,text:o.Translate.string("Yes")},{key:!1,value:!1,text:o.Translate.string("No")}];return a.createElement(a.Fragment,null,a.createElement(_.FinalInput,{name:"placesLimit",type:"number",label:o.Translate.string("Places limit"),placeholder:o.Translate.string("None","Places limit"),step:"1",min:"1",validate:_.validators.optional(_.validators.min(0)),parse:e=>""===e?0:+e,format:e=>0===e?"":e}),a.createElement(_.FinalDropdown,{name:"defaultValue",label:o.Translate.string("Default value"),options:e,placeholder:o.Translate.string("None","Default value"),selection:!0}))},hasPrice:!0,icon:"switchon",renderAsFieldset:!0},phone:{title:o.Translate.string("Phone"),inputComponent:Ii,icon:"phone"},country:{title:o.Translate.string("Country"),inputComponent:ci,settingsComponent:mi,icon:"earth"},file:{title:o.Translate.string("File"),inputComponent:Ei,icon:"upload",renderAsFieldset:!0},email:{title:o.Translate.string("Email"),inputComponent:vi,icon:"mail"},single_choice:{title:o.Translate.string("Single Choice"),inputComponent:Oi,settingsComponent:function(){return a.createElement(a.Fragment,null,a.createElement(_.FinalDropdown,{name:"itemType",label:o.Translate.string("Widget type"),options:[{key:"dropdown",value:"dropdown",text:o.Translate.string("Drop-down list")},{key:"radiogroup",value:"radiogroup",text:o.Translate.string("Radio buttons")}],selection:!0,required:!0}),a.createElement(pt.Field,{name:"choices",subscription:{value:!0},isEqual:ie().isEqual},(({input:{value:e}})=>a.createElement(_.FinalDropdown,{name:"defaultItem",label:o.Translate.string("Default option"),options:e.filter((e=>e.isEnabled)).map((e=>({key:e.id,value:e.id,text:e.caption}))),disabled:!e.some((e=>e.isEnabled)),parse:_.parsers.nullIfEmpty,selection:!0}))),a.createElement(_.FinalCheckbox,{name:"withExtraSlots",label:o.Translate.string("Enable extra slots")}),a.createElement(pt.Field,{name:"withExtraSlots",subscription:{value:!0}},(({input:{value:e}})=>a.createElement(_.FinalField,{name:"choices",label:o.Translate.string("Choices"),component:Ht,withExtraSlots:e,isEqual:ie().isEqual,required:!0}))))},settingsModalSize:"small",settingsFormDecorators:[Zt,ji],settingsFormInitialData:{choices:[],itemType:"dropdown",defaultItem:null,withExtraSlots:!1},icon:"dropmenu",renderAsFieldset:e=>"radiogroup"===e.itemType},multi_choice:{title:o.Translate.string("Multiple Choice"),inputComponent:Ri,settingsComponent:function(){return a.createElement(a.Fragment,null,a.createElement(pt.Field,{name:"choices",subscription:{value:!0}},(({input:{value:e}})=>{const t=e.length>0?1:0,i=e.length>0?e.length:0;return a.createElement(_.FinalInput,{name:"maxChoices",type:"number",placeholder:o.Translate.string("Unlimited","Number of choices"),step:"1",min:t,max:i,validate:_.validators.optional(_.validators.range(t,i)),label:o.Translate.string("Maximum number of choices"),description:o.Translate.string("Maximum number of choices that can be selected. Leave empty to unset.")})})),a.createElement(_.FinalCheckbox,{name:"withExtraSlots",label:o.Translate.string("Enable extra slots")}),a.createElement(pt.Field,{name:"withExtraSlots",subscription:{value:!0}},(({input:{value:e}})=>a.createElement(_.FinalField,{name:"choices",label:o.Translate.string("Choices"),component:Ht,withExtraSlots:e,isEqual:ie().isEqual,required:!0}))))},settingsModalSize:"small",settingsFormDecorators:[Zt],settingsFormInitialData:{choices:[],withExtraSlots:!1},icon:"list",renderAsFieldset:!0},accommodation:{title:o.Translate.string("Accommodation"),inputComponent:Wt,settingsComponent:function(){return a.createElement(a.Fragment,null,a.createElement(Ot.c,{name:"arrival",label:o.Translate.string("Arrival"),required:!0}),a.createElement(Ot.c,{name:"departure",label:o.Translate.string("Departure"),extraPickerProps:{noBorder:!0},required:!0}),a.createElement(_.FinalField,{name:"choices",label:o.Translate.string("Choices"),component:Ht,isEqual:ie().isEqual,forAccommodation:!0,required:!0,validate:e=>{if(!e.some((e=>e.isEnabled)))return o.Translate.string("You need to have at least one enabled option.")}}))},settingsModalSize:"small",settingsFormDecorators:[Zt],settingsFormInitialData:e=>({choices:[{id:"new:no-accommodation",caption:"No accommodation",isEnabled:!0,isNoAccommodation:!0,price:0,placesLimit:0}],arrival:{startDate:(0,jt.serializeDate)((0,jt.toMoment)(e.eventStartDate,Lt().HTML5_FMT.DATE).subtract(2,"days")),endDate:(0,jt.serializeDate)((0,jt.toMoment)(e.eventEndDate,Lt().HTML5_FMT.DATE))},departure:{startDate:(0,jt.serializeDate)((0,jt.toMoment)(e.eventStartDate,Lt().HTML5_FMT.DATE).add(1,"days")),endDate:(0,jt.serializeDate)((0,jt.toMoment)(e.eventEndDate,Lt().HTML5_FMT.DATE).add(3,"days"))}}),settingsFormValidator:function({arrival:e,departure:t}){const i=(0,jt.toMoment)(e.startDate,Lt().HTML5_FMT.DATE),a=(0,jt.toMoment)(e.endDate,Lt().HTML5_FMT.DATE),n=(0,jt.toMoment)(t.startDate,Lt().HTML5_FMT.DATE),r=(0,jt.toMoment)(t.endDate,Lt().HTML5_FMT.DATE),s={};if(i&&a&&n&&r)return n.isBefore(i)&&(s.departure=o.Translate.string("The departure period cannot begin before the arrival period.")),a.isAfter(r)&&(s.arrival=o.Translate.string("The arrival period cannot end after the departure period.")),s},noRequired:!0,alwaysRequired:!0,icon:"home",renderAsFieldset:!0},accompanying_persons:{title:o.Translate.string("Accompanying Persons"),inputComponent:ti,settingsComponent:function(){return a.createElement(a.Fragment,null,a.createElement(_.FinalInput,{name:"maxPersons",type:"number",label:o.Translate.string("Maximum per registrant"),placeholder:o.Translate.string("No maximum"),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),fluid:!0,format:e=>e||"",parse:e=>+e||0}),a.createElement(_.FinalCheckbox,{name:"personsCountAgainstLimit",label:o.Translate.string("Accompanying persons count against registration limit")}))},settingsFormInitialData:{maxPersons:1,personsCountAgainstLimit:!1},settingsModalSize:"tiny",noRequired:!0,hasPrice:!0,icon:"user",renderAsFieldset:!0},picture:{title:o.Translate.string("Picture"),inputComponent:Ni,icon:"image",settingsComponent:function(){return a.createElement(_.FinalInput,{name:"minPictureSize",type:"number",label:o.Translate.string("Minimum picture size"),placeholder:o.Translate.string("Unlimited","Minimum size"),description:o.Translate.string("Minimum picture size that can be uploaded in pixels. Leave empty for no min size validation."),step:"1",min:"25",max:"1000",validate:_.validators.optional(_.validators.range(25,1e3)),fluid:!0})}},sessions:{title:o.Translate.string("Timetable Sessions"),inputComponent:Gi,settingsComponent:function(){return a.createElement(a.Fragment,null,a.createElement(_.FinalCheckbox,{name:"collapseDays",label:o.Translate.string("Collapse days"),showAsToggle:!0}),a.createElement(_.FinalInput,{name:"minimum",type:"number",label:o.Translate.string("Minimum number of choices"),placeholder:o.Translate.string("No minimum"),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),format:e=>e||"",parse:e=>+e||0,fluid:!0}),a.createElement(_.FinalInput,{name:"maximum",type:"number",label:o.Translate.string("Maximum number of choices"),placeholder:o.Translate.string("No maximum"),step:"1",min:"0",validate:_.validators.optional(_.validators.min(0)),format:e=>e||"",parse:e=>+e||0,fluid:!0}))},settingsFormInitialData:{collapse_days:!1,minimum:0,maximum:0},settingsFormValidator:function({minimum:e,maximum:t}){if(e&&t&&e>t){const e=o.Translate.string("The minimum value cannot be greater than the maximum value.");return{minimum:e,maximum:e}}},noRequired:!0,hasPrice:!1,icon:"calendar-day",renderAsFieldset:!0}};function Wi(){const e=Object.fromEntries((0,wt.getPluginObjects)("regformCustomFields").map((({name:e,...t})=>[e,t])));if(Object.entries(e).some((([e,t])=>!(e.startsWith("ext__")||t.unsafeOverrideField&&Ki[e]))))throw new Error("Field names from plugins must begin with `ext__` or match an existing field name and set the `unsafeOverrideField` property to true");return{...Ki,...e}}const Qi={"../../styles/regform.module.scss":{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"}};function Xi({management:e}){const t=a.createElement(o.Translate,null,"This field is locked since changing it could trigger a price change."),i=e?a.createElement(a.Fragment,null,t," ",a.createElement(o.Translate,null,"As a manager you can modify it nonetheless.")):t;return a.createElement(P.A,{trigger:a.createElement(T.A,{name:e?"lock open":"lock"})},i)}function ea({isUpdateMode:e}){const t=a.createElement(o.Translate,null,"This field is locked due to an expired retention period."),i=e?a.createElement(a.Fragment,null,t," ",a.createElement(o.Translate,null,"The associated registration data has been deleted.")):t;return a.createElement(P.A,{trigger:a.createElement(T.A,{name:"lock"})},i)}function ta({reason:e}){return a.createElement(P.A,{trigger:a.createElement(T.A,{name:"lock"})},e)}function ia({id:e,title:t,description:i,retentionPeriod:n,inputType:r,isEnabled:s,isRequired:l,isPurged:d,lockedReason:c,sortHandle:m,setupMode:_,setupActions:u,...g}){const p=(0,oe.useSelector)((t=>Ft(t,e))),f=(0,oe.useSelector)(Ct),y=(0,oe.useSelector)(xt),{htmlName:v}=g,b=Wi()[r]||{},h=b.inputComponent,E={title:t,description:i,isEnabled:s,fieldId:e,...g},D=!_&&d,R=!s||D||!!c||p&&!f,w={id:e,title:t,description:i,retentionPeriod:n,inputType:r,isEnabled:s,isRequired:l,isPurged:d,lockedReason:c,sortHandle:m,setupMode:_,setupActions:u,...g,meta:b};let x=null;_&&n&&(x=a.createElement(T.A,{name:"clock outline",color:"red",style:{marginLeft:"3px"},title:o.PluralTranslate.string("Field data will be purged {retentionPeriod} week after the event ended.","Field data will be purged {retentionPeriod} weeks after the event ended.",n,{retentionPeriod:n})}));const I=b.alwaysRequired||l,A=!f&&I,C=`input-${E.fieldId}`,P=h&&!b.customFormItem?a.createElement(a.Fragment,null,x,a.createElement(h,(0,q.A)({isRequired:A,disabled:R,isPurged:D,htmlId:C},E))):null;return a.createElement("div",{"data-html-name":v,className:(0,O.A)(`form-item ${(0,Rt.toClasses)({disabled:!s||p,"purged-disabled":D,"paid-disabled":!D&&p,editable:_})}`,Qi,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},m,a.createElement("div",{className:"events-registration-client-styles-___regform-module__content___dKw31"},h?b.customFormItem?a.createElement(h,(0,q.A)({showAsRequired:I,isRequired:A,disabled:R,isPurged:D,retentionPeriodIcon:x,htmlId:C},E)):a.createElement(qt.A.Field,{required:I,className:"events-registration-client-styles-___regform-module__field___mpG7J"},function(e,t){return"function"==typeof t.renderAsFieldset?t.renderAsFieldset(e):t.renderAsFieldset}(w,b)?a.createElement("fieldset",{id:C,disabled:R},a.createElement("legend",null,t),P):a.createElement(a.Fragment,null,a.createElement("label",{htmlFor:C,style:{opacity:R?.8:1,display:"inline-block"}},t),P)):`Unknown input type: ${r}`,i&&a.createElement("div",{className:"events-registration-client-styles-___regform-module__description___abkAU"},a.createElement(Rt.Markdown,{targetBlank:!0},i)),(0,wt.renderPluginComponents)(`regform-${r}-field-item`,E)),u&&a.createElement("div",{className:"events-registration-client-styles-___regform-module__actions___yuXgO"},u),c&&a.createElement(ta,{reason:c}),!c&&D&&a.createElement(ea,{isUpdateMode:y}),!c&&!D&&p&&a.createElement(Xi,{management:f}))}Xi.propTypes={management:l().bool.isRequired},ea.propTypes={isUpdateMode:l().bool.isRequired},ta.propTypes={reason:l().string.isRequired},ia.propTypes={id:l().number.isRequired,title:l().string.isRequired,description:l().string.isRequired,isEnabled:l().bool.isRequired,position:l().number.isRequired,isRequired:l().bool,isPurged:l().bool.isRequired,lockedReason:l().string,retentionPeriod:l().number,fieldIsPersonalData:l().bool,fieldIsRequired:l().bool,htmlName:l().string,inputType:l().string.isRequired,sortHandle:l().node,setupMode:l().bool,setupActions:l().node},ia.defaultProps={fieldIsPersonalData:!1,fieldIsRequired:!1,isRequired:!1,lockedReason:"",retentionPeriod:null,htmlName:null,sortHandle:null,setupMode:!1,setupActions:null};const aa={"../../styles/regform.module.scss":{"setup-toolbar":"events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv","disabled-sections":"events-registration-client-styles-___regform-module__disabled-sections___TthNB",actions:"events-registration-client-styles-___regform-module__actions___yuXgO","form-item":"events-registration-client-styles-___regform-module__form-item___AlbiE",disabled:"events-registration-client-styles-___regform-module__disabled___A4p+q",content:"events-registration-client-styles-___regform-module__content___dKw31","paid-disabled":"events-registration-client-styles-___regform-module__paid-disabled___e8zT-","purged-disabled":"events-registration-client-styles-___regform-module__purged-disabled___oo16L",label:"events-registration-client-styles-___regform-module__label___t11lD",field:"events-registration-client-styles-___regform-module__field___mpG7J","price-tag":"events-registration-client-styles-___regform-module__price-tag___pz3tt","places-left":"events-registration-client-styles-___regform-module__places-left___6O4Ev",greyed:"events-registration-client-styles-___regform-module__greyed___HZLen","number-field":"events-registration-client-styles-___regform-module__number-field___LtuaG","date-field":"events-registration-client-styles-___regform-module__date-field___LToLh","file-field":"events-registration-client-styles-___regform-module__file-field___1Nup7","accommodation-field":"events-registration-client-styles-___regform-module__accommodation-field___WHQ+0","date-picker":"events-registration-client-styles-___regform-module__date-picker___zVaWU","accompanyingpersons-field":"events-registration-client-styles-___regform-module__accompanyingpersons-field___MUvS6",light:"events-registration-client-styles-___regform-module__light___gdy5g",summary:"events-registration-client-styles-___regform-module__summary___Krn7Y","single-choice-dropdown":"events-registration-client-styles-___regform-module__single-choice-dropdown___tzmJ5","extra-slots":"events-registration-client-styles-___regform-module__extra-slots___5sb-R","dropdown-text":"events-registration-client-styles-___regform-module__dropdown-text___GB4OB",caption:"events-registration-client-styles-___regform-module__caption___u54ZN",labels:"events-registration-client-styles-___regform-module__labels___Zy8f7","single-choice-radio-group":"events-registration-client-styles-___regform-module__single-choice-radio-group___E9qIt",description:"events-registration-client-styles-___regform-module__description___abkAU",editable:"events-registration-client-styles-___regform-module__editable___ZHQMz","sortable-handle":"events-registration-client-styles-___regform-module__sortable-handle___yz1-x","header-wrapper":"events-registration-client-styles-___regform-module__header-wrapper___U6gJN","section-sortable-handle":"events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH","manager-only":"events-registration-client-styles-___regform-module__manager-only___PQwvG","section-actions":"events-registration-client-styles-___regform-module__section-actions___p3bRe","dropdown-menu":"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D","dropdown-item":"events-registration-client-styles-___regform-module__dropdown-item___chpZW"}};function na({title:e,description:t,isManagerOnly:i,items:n,sortHandle:r,itemComponent:s,itemProps:l,setupMode:d,setupActions:c}){const m=n.filter((e=>e.isEnabled)),_=d?n.filter((e=>!e.isEnabled)):[],u=a.createElement(P.A,{content:o.Translate.string("This section is only visible to managers."),trigger:a.createElement("i",{className:"icon-user-reading",style:{marginRight:5}})});return a.createElement("div",{className:"regform-section "+(0,O.A)(i?"manager-only":null,aa,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},a.createElement("div",{className:"i-box-header"},r,a.createElement("div",{className:"events-registration-client-styles-___regform-module__header-wrapper___U6gJN"},a.createElement("div",{className:"i-box-title"},i?u:null,e),a.createElement("div",{className:"i-box-description"},a.createElement(Rt.Markdown,{targetBlank:!0},t))),c&&a.createElement("div",{className:"i-box-buttons events-registration-client-styles-___regform-module__section-actions___p3bRe"},c)),a.createElement(qt.A,{as:"div",className:"i-box-content"},m.map(((e,t)=>a.createElement(s,(0,q.A)({key:e.id,index:t,setupMode:d},l,e)))),_.length>0&&a.createElement(a.Fragment,null,a.createElement("div",{className:"titled-rule section-field-divisor"},a.createElement(o.Translate,null,"Disabled fields")," ",a.createElement("i",{className:"info-helper",title:o.Translate.string("These fields won't be displayed to registrants")})),_.map(((e,t)=>a.createElement(s,(0,q.A)({key:e.id,index:t,setupMode:d},l,e)))))))}na.propTypes={id:l().number.isRequired,title:l().string.isRequired,description:l().string.isRequired,enabled:l().bool.isRequired,position:l().number.isRequired,isManagerOnly:l().bool.isRequired,isPersonalData:l().bool.isRequired,items:l().arrayOf(l().shape(ia.propTypes)).isRequired,sortHandle:l().node,itemComponent:l().elementType,itemProps:l().object,setupMode:l().bool,setupActions:l().node},na.defaultProps={setupMode:!1,setupActions:null,sortHandle:null,itemComponent:ia,itemProps:{}};var ra=i(32341),sa=i(49138);function la({newItemType:e,inModal:t,onClick:i}){const n=Wi(),r=e?n[e].title:o.Translate.string("Choose type");let s;s=t?{icon:"dropdown",text:r}:{icon:null,className:"hide-if-locked",trigger:a.createElement("a",{className:"icon-plus",title:o.Translate.string("Add field")})};const l=Object.entries(n).filter((([e])=>"label"!==e)).map((([e,{title:t,icon:i}])=>({key:e,value:e,text:t,icon:i}))),d=Math.ceil(l.length/2);return a.createElement(sa.A,(0,q.A)({selectOnNavigation:!1,selectOnBlur:!1,value:e},s),a.createElement(sa.A.Menu,null,a.createElement(oa,{value:"label",text:n.label.title,icon:n.label.icon,centered:!0,onClick:i}),a.createElement(sa.A.Divider,{style:{margin:0}}),a.createElement("div",{className:"events-registration-client-styles-___regform-module__dropdown-menu___9uq+D"},a.createElement("div",null,l.slice(0,d).map((({key:e,...t})=>a.createElement(oa,(0,q.A)({key:e,onClick:i},t))))),a.createElement("div",null,l.slice(d).map((({key:e,...t})=>a.createElement(oa,(0,q.A)({key:e,onClick:i},t))))))))}function oa({value:e,text:t,icon:i,centered:n,onClick:r}){return a.createElement("div",{className:"events-registration-client-styles-___regform-module__dropdown-item___chpZW",style:n?{textAlign:"center"}:null,onClick:()=>r(e)},a.createElement("i",{className:`icon-${i}`}),a.createElement("span",null,t))}la.propTypes={newItemType:l().string,inModal:l().bool.isRequired,onClick:l().func.isRequired},la.defaultProps={newItemType:null},oa.propTypes={value:l().string.isRequired,text:l().string.isRequired,icon:l().string.isRequired,centered:l().bool,onClick:l().func.isRequired},oa.defaultProps={centered:!1};const da={};function ca({id:e,sectionId:t,defaultNewItemType:i,onClose:n}){const r=(0,oe.useDispatch)(),[s,l]=(0,a.useState)(i),d=null!==e,c=(0,oe.useSelector)(_e),m=(0,oe.useSelector)(Ae),{inputType:u,fieldIsRequired:p,...f}=(0,oe.useSelector)((t=>d?pe(t,e):da)),y=d?u:s,v=Wi(),b=!(y in v),h=v[y]||{},E=h.settingsComponent;let D=f;d||(D=ie().isFunction(h.settingsFormInitialData)?h.settingsFormInitialData(c):h.settingsFormInitialData,h.hasPrice&&(D={...D||{},price:0}));return a.createElement(Dt.Sz,{key:d?"edit":`new-${s}`,id:"regform-item-settings",onSubmit:async(i,a)=>{const s=(0,_.getValuesForFields)(i,a),l=d?function(e,t){return async(i,a)=>{const n=a(),r=Re(n,e),s=xe(n,e)(Fe,Ne)(Ie(n)(r,e)),l={fieldData:t},o=await(0,de.HX)((()=>g.indicoAxios.patch(s,l)))(i);return o.error||i(st(e,o.data.view_data)),(0,ce.camelizeKeys)(o)}}(e,s):mt(t,y,s),o=await r(l);if(o.error)return o.error;n()},onClose:n,initialValues:D,initialValuesEqual:ie().isEqual,unloadPrompt:!0,size:h.settingsModalSize||"tiny",decorators:h.settingsFormDecorators?h.settingsFormDecorators:void 0,validate:h.settingsFormValidator,header:d?a.createElement(o.Translate,null,'Configure field "',a.createElement(o.Param,{name:"section",value:f.title}),'"'):a.createElement(a.Fragment,null,a.createElement(o.Translate,null,"Add new field"),a.createElement("div",{style:{float:"right"}},a.createElement(pt.FormSpy,{subscription:{dirty:!0}},(({dirty:e})=>a.createElement(la,{newItemType:s,inModal:!0,onClick:t=>((e,t)=>{s&&e&&!confirm("Changing the type will reset this form.")||l(t)})(e,t)})))))},d||s?a.createElement(a.Fragment,null,a.createElement(_.FinalInput,{name:"title",label:o.Translate.string("Title"),required:!0,autoFocus:!0}),a.createElement(_.FinalTextArea,{name:"description",label:o.Translate.string("Description"),description:a.createElement(o.Translate,null,"You may use Markdown for formatting.")}),h.hasPrice&&a.createElement(_.FinalInput,{name:"price",type:"number",min:"0",step:"0.01",validate:_.validators.min(0),parse:e=>_.parsers.number(e,!0,0),label:o.Translate.string("Price")}),!h.noRequired&&a.createElement(_.FinalCheckbox,{name:"isRequired",label:o.Translate.string("Required field"),disabled:p}),E&&a.createElement(E,f),(0,wt.renderPluginComponents)(`regform-${y}-field-settings`,{...f}),!h.noRetentionPeriod&&!p&&a.createElement(ra.Fieldset,{legend:o.Translate.string("Privacy"),compact:!0},a.createElement(_.FinalInput,{name:"retentionPeriod",type:"number",placeholder:o.Translate.string("Permanent"),step:"1",min:m.min,max:m.max,validate:_.validators.optional(_.validators.range(m.min,m.max)),label:o.Translate.string("Retention period (weeks)"),description:o.Translate.string("Specify how long user-provided data for this field will be preserved in the database.")}),a.createElement(pt.FormSpy,{subscription:{values:!0}},(({values:e})=>(e.price||e.isPriceSet)&&e.retentionPeriod?a.createElement(k.A,{visible:!0,icon:!0,warning:!0},a.createElement(T.A,{name:"warning"}),a.createElement(k.A.Content,null,a.createElement(o.Translate,null,"Please note that invoice information will be lost as well once a field's retention period expires."))):""))),b&&a.createElement(k.A,{visible:!0,warning:!0},"Unknown input type: ",y,".",a.createElement("br",null),"Saving changes will most likely fail or result in some settings being lost.")):a.createElement(k.A,{info:!0},a.createElement(o.Translate,null,"Please choose a field type.")))}function ma({id:e,isPersonalData:t}){const[i,n]=(0,a.useState)(!1),[r,s]=(0,a.useState)(!1),[l,d]=(0,a.useState)(null),c=(0,oe.useDispatch)();return a.createElement(a.Fragment,null,!t&&a.createElement("a",{className:"icon-disable hide-if-locked",title:o.Translate.string("Disable section"),onClick:()=>{var t;c((t=e,async(e,i)=>{const a=i(),n=Ie(a)(t),r=Ue({...n,enable:"false"}),s=await tt((()=>g.indicoAxios.post(r)))(e);s.error||(e(nt(t,!1)),e(it(s.data.positions)))}))}}),a.createElement("a",{className:"icon-settings hide-if-locked",title:o.Translate.string("Configure section"),onClick:()=>{n(!0)}}),a.createElement(la,{inModal:!1,onClick:e=>{d(e),s(!0)}}),i&&a.createElement(Tt,{id:e,onClose:()=>n(!1)}),r&&a.createElement(ca,{sectionId:e,defaultNewItemType:l,onClose:()=>s(!1)}))}function _a({id:e,title:t,fieldIsRequired:i,fieldIsPersonalData:n,isEnabled:r}){const s=(0,oe.useDispatch)(),[l,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)(!1);return a.createElement(a.Fragment,null,!n&&a.createElement("a",{className:"icon-remove hide-if-locked",title:o.Translate.string("Remove field"),onClick:()=>{m(!0)}}),!r&&a.createElement("a",{className:"icon-checkmark hide-if-locked",title:o.Translate.string("Enable field"),onClick:()=>{var t;s((t=e,async(e,i)=>{const a=i(),n=Re(a,t),r=xe(a,t)(ze,je)({...Ie(a)(n,t),enable:"true"}),s=await tt((()=>g.indicoAxios.post(r)))(e);s.error||(e(st(t,s.data.view_data)),e(it(s.data.positions)))}))}}),!i&&r&&a.createElement("a",{className:"icon-disable hide-if-locked",title:o.Translate.string("Disable field"),onClick:()=>{var t;s((t=e,async(e,i)=>{const a=i(),n=Re(a,t),r=xe(a,t)(ze,je)({...Ie(a)(n,t),enable:"false"}),s=await tt((()=>g.indicoAxios.post(r)))(e);s.error||(e(st(t,s.data.view_data)),e(it(s.data.positions)))}))}}),a.createElement("a",{className:"icon-settings hide-if-locked",title:o.Translate.string("Configure field"),onClick:()=>{d(!0)}}),l&&a.createElement(ca,{id:e,onClose:()=>d(!1)}),a.createElement(R.RequestConfirmDelete,{requestFunc:()=>s(ct(e)),onClose:()=>m(!1),open:c,persistent:!0},a.createElement(o.Translate,null,'Are you sure you want to delete the field "',a.createElement(o.Param,{name:"field",value:t,wrapper:a.createElement("strong",null)}),'"?')))}function ua({index:e,sectionId:t,...i}){const{id:n,isEnabled:r}=i,s=(0,oe.useDispatch)(),[l,o,d]=(0,ft.f)({type:`regform-item@${t}`,id:n,index:e,separateHandle:!0,active:r,moveItem:(e,i)=>{s(rt(t,e,i))},onDrop:e=>{e.index!==e.originalIndex&&s(function(e,t,i,a){return async(n,r)=>{const s=r(),l=xe(s,t)(Oe,Me)(Ie(s)(e,t));(await tt((()=>g.indicoAxios.post(l,{endPos:i})))(n)).error&&n(rt(e,i,a))}}(t,e.id,e.index,e.originalIndex))}});return a.createElement("div",{ref:o,style:d},a.createElement(ia,(0,q.A)({sortHandle:a.createElement("div",{className:"hide-if-locked events-registration-client-styles-___regform-module__sortable-handle___yz1-x",ref:l}),setupActions:a.createElement(_a,i)},i)))}ca.propTypes={id:l().number,sectionId:l().number,defaultNewItemType:l().string,onClose:l().func.isRequired},ca.defaultProps={id:null,sectionId:null,defaultNewItemType:null},ma.propTypes={id:l().number.isRequired,isPersonalData:l().bool.isRequired},_a.propTypes={id:l().number.isRequired,title:l().string.isRequired,fieldIsRequired:l().bool.isRequired,fieldIsPersonalData:l().bool.isRequired,isEnabled:l().bool.isRequired};const ga=ie().pick(ia.propTypes,"inputType","isEnabled",...Object.keys(_a.propTypes));function pa({index:e,...t}){const{id:i}=t,n=(0,oe.useDispatch)(),[r,s,l]=(0,ft.f)({type:"regform-section",id:i,index:e,separateHandle:!0,moveItem:(e,t)=>{n(at(e,t))},onDrop:e=>{var t,i,a;e.index!==e.originalIndex&&n((t=e.id,i=e.index,a=e.originalIndex,async(e,n)=>{const r=n(),s=Le(Ie(r)(t));(await tt((()=>g.indicoAxios.post(s,{endPos:i})))(e)).error&&e(at(i,a))}))}});return a.createElement("div",{ref:s,style:l},a.createElement(ft.S,{accept:`regform-item@${i}`},a.createElement(na,(0,q.A)({sortHandle:a.createElement("div",{className:"hide-if-locked events-registration-client-styles-___regform-module__section-sortable-handle___ABMeH",ref:r}),setupActions:a.createElement(ma,t),itemComponent:ua,itemProps:{sectionId:i}},t))))}ua.propTypes={sectionId:l().number.isRequired,index:l().number.isRequired,...ga},ua.defaultProps=ie().pick(ia.defaultProps,Object.keys(ga));const fa=ie().pick(na.propTypes,"id");function ya(){const e=(0,oe.useSelector)(he),t=(0,oe.useSelector)(Te),i=(0,oe.useSelector)(ge),n=(0,oe.useSelector)(De),[r,s]=(0,a.useState)(!1),[l,m]=(0,a.useState)(!1),_=Object.fromEntries(Object.entries(i).map((([,{htmlName:e,defaultValue:t}])=>[e,t])));return a.createElement(d.A.Dimmable,{dimmed:n},a.createElement(ut.Q,{backend:gt.t2},a.createElement("div",{className:"toolbar events-registration-client-styles-___regform-module__setup-toolbar___tu1Kv"},a.createElement(R.IButton,{icon:"plus",onClick:()=>m(!0)},a.createElement(o.Translate,null,"Add section")),t.length>0&&a.createElement(R.IButton,{onClick:()=>s(!0)},a.createElement(o.Translate,null,"Disabled sections"))),a.createElement(pt.Form,{initialValues:_,subscription:{initialValues:!0},onSubmit:()=>{}},(t=>{const i=e.map((e=>({...e,items:e.items.filter((e=>e.htmlName in t.initialValues))})));return a.createElement(ft.S,{accept:"regform-section",className:"regform-section-list"},i.map(((e,t)=>a.createElement(pa,(0,q.A)({key:e.id,index:t},e,{setupMode:!0})))))}))),l&&a.createElement(Tt,{onClose:()=>m(!1)}),r&&a.createElement(Et,{onClose:()=>s(!1)}),a.createElement(d.A,{inverted:!0,active:n},a.createElement(c.A,{size:"massive"},a.createElement(o.Translate,null,"Saving..."))))}function va(e){const{eventId:t,eventStartDate:i,eventEndDate:r,regformId:s,currency:l,dataRetentionRange:o,hasPredefinedAffiliations:d,formData:c}=e.dataset,m={staticData:{eventId:parseInt(t,10),regformId:parseInt(s,10),hasPredefinedAffiliations:JSON.parse(d),eventStartDate:i,eventEndDate:r,currency:l,dataRetentionRange:JSON.parse(o)}},_=(0,de.Ay)("regform-setup",_t,m);var u;_.dispatch((u=JSON.parse(c),{type:Ve,items:u.items,sections:u.sections})),n.render(a.createElement(oe.Provider,{store:_},a.createElement(ya,null)),e)}pa.propTypes={index:l().number.isRequired,...fa};const ba="Set form data";const ha={items:(e={},t)=>t.type===ba?t.items:e,sections:(e={},t)=>t.type===ba?t.sections:e},Ea="input:not([type=hidden]):not([type=file]),button,select,textarea",Da={agreed_to_privacy_policy:{label:o.Translate.string("Privacy policy"),id:"finalfield-agreed_to_privacy_policy"},consent_to_publish:{label:o.Translate.string("Participant list"),id:"input-consent-to-publish"}};function Ta(){const e=(0,oe.useSelector)(Ee),{errors:t}=(0,pt.useFormState)({errors:!0}),i=[];for(const a in t){const n=e.get(a)||Da[a];n?i.push({...n,message:t[a]}):console.warn(`FormErrorList: Field ${a} is not registered with the final form and will not be shown in the error list`)}function n(e){e.preventDefault();const t=e.target.href.split("#")[1];let i=document.getElementById(t);!i||i.matches(Ea)||i.tagName.startsWith("IND-")||(i=i.querySelector(Ea)),i?i.focus():console.warn(`FormErrorList: #${t} does not match a form field. Please make sure all form fields or their containing fieldset have an appropriate id.`)}return i.length?a.createElement("div",{className:"events-registration-client-js-form-___FormErrorList-module__form-error-list___Nv3hw"},a.createElement(o.Translate,{as:"h4"},"You need to review some of the fields"),a.createElement("ul",{"aria-label":o.Translate.string("Fields with errors")},i.map((e=>a.createElement("li",{key:e.id},a.createElement("a",{href:`#${e.id}`,"aria-label":o.Translate.string("Visit incomplete field {field}: {error}",{field:e.label,error:e.message}),onClick:n},e.label,": ",e.message)))))):null}const qa=r.Ay.bind(null,{endpoint:"events.display_privacy",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1}]}]},"/");function Ra({url:e}){const t=a.createElement(o.Translate,null,"I have read and agree to the"," ",a.createElement(o.Param,{name:"url",wrapper:a.createElement("a",{href:e,target:"_blank",rel:"noreferrer"})},"Privacy policy"));return a.createElement(k.A,{info:!0,style:{marginTop:25}},a.createElement(k.A.Header,null,a.createElement(o.Translate,null,"Privacy Policy")),a.createElement(qt.A,{as:"div",style:{marginTop:10}},a.createElement(_.FinalCheckbox,{required:!0,label:t,name:"agreed_to_privacy_policy",showAsToggle:!0})))}function wa({isUpdateMode:e}){return a.createElement(k.A,{info:!0,style:{marginTop:25}},a.createElement(k.A.Header,null,a.createElement(o.Translate,null,"Management Options")),a.createElement("div",null,a.createElement(_.FinalCheckbox,{fieldProps:{style:{marginTop:10}},label:o.Translate.string("Send an email notification to the user"),name:"notify_user",showAsToggle:!0}),!e&&a.createElement(_.FinalCheckbox,{fieldProps:{style:{marginTop:10}},label:o.Translate.string("Ignore field requirements for custom fields"),name:"override_required",showAsToggle:!0})))}function xa({publishToParticipants:e,publishToPublic:t}){const i="show_all"===e&&"show_all"===t;return a.createElement(k.A,{info:!i,warning:i,style:{marginTop:25}},a.createElement(k.A.Header,null,a.createElement(o.Translate,null,"Participant list")),("show_with_consent"===e||"show_with_consent"===t)&&a.createElement("p",null,a.createElement(o.Translate,null,"Specify whether you consent to being included in the event's list of participants")),a.createElement(qt.A,{as:"div"},a.createElement(x,{name:"consent_to_publish",publishToParticipants:e,publishToPublic:t,useFinalForms:!0})))}function Ia(){const e=(0,oe.useSelector)(he),{eventId:t,submitUrl:i,registrationData:n,initialValues:r,captchaRequired:s,captchaSettings:l,policyAgreementRequired:d}=(0,oe.useSelector)(_e),c=(0,oe.useSelector)(xt),m=(0,oe.useSelector)(At),u=(0,oe.useSelector)(Ct),p=(0,oe.useSelector)(St),f=(0,oe.useSelector)(Nt),y=!u&&"hide_all"!==p;return a.createElement(pt.Form,{onSubmit:async(e,t)=>{let a;e=ie().omit(e,"agreed_to_privacy_policy");const n=c?(0,_.getChangedValues)(e,t,["notify_user"]):e;try{a=await g.indicoAxios.post(i,n)}catch(e){return(0,_.handleSubmitError)(e)}a.data.redirect&&(location.href=a.data.redirect,await new Promise((()=>{})))},initialValues:c?n:r,initialValuesEqual:ie().isEqual,subscription:{},decorators:(0,wt.getPluginObjects)("regformFormDecorators")},(i=>a.createElement("form",{onSubmit:i.handleSubmit},(0,wt.renderPluginComponents)("regformBeforeSections"),e.map((e=>a.createElement(na,(0,q.A)({key:e.id},e)))),(0,wt.renderPluginComponents)("regformAfterSections"),a.createElement("div",null,u&&a.createElement(wa,{isUpdateMode:c}),y&&a.createElement(xa,{publishToParticipants:p,publishToPublic:f}),s&&a.createElement(R.Captcha,{settings:l}),!u&&!c&&d&&a.createElement(Ra,{url:qa({event_id:t})}),a.createElement(Ta,null),a.createElement(_.FinalSubmitButton,{disabledUntilChange:!1,disabledIfInvalid:!1,label:c?o.Translate.string("Modify"):m?o.Translate.string("Apply","Registration"):o.Translate.string("Register"),style:{marginTop:20,textAlign:"right"}})))))}function Aa(e){const{eventId:t,regformId:i,currency:r,management:s,paid:l,moderated:o=!1,submitUrl:d,formData:c,initialValues:m=null,registrationData:_=null,registrationUuid:u=null,fileData:g=null,publishToParticipants:p,publishToPublic:f,consentToPublish:y=null,policyAgreementRequired:v,captchaRequired:b=!1,captchaSettings:h=null,...E}=e.dataset,D={staticData:{eventId:parseInt(t,10),regformId:parseInt(i,10),management:JSON.parse(s),paid:!!l&&JSON.parse(l),moderated:JSON.parse(o),initialValues:JSON.parse(m),submitUrl:d,registrationData:_?{...JSON.parse(_),consent_to_publish:y}:{},registrationUuid:u,fileData:g?JSON.parse(g):{},currency:r,publishToParticipants:p,publishToPublic:f,policyAgreementRequired:JSON.parse(v),captchaRequired:JSON.parse(b),captchaSettings:JSON.parse(h),extraData:E}},T=(0,de.Ay)("regform-submission",ha,D);var q;T.dispatch((q=JSON.parse(c),{type:ba,items:q.items,sections:q.sections})),n.render(a.createElement(oe.Provider,{store:T},a.createElement(Ia,null)),e)}Ra.propTypes={url:l().string.isRequired},wa.propTypes={isUpdateMode:l().bool.isRequired},xa.propTypes={publishToParticipants:l().oneOf(["hide_all","show_with_consent","show_all"]).isRequired,publishToPublic:l().oneOf(["hide_all","show_with_consent","show_all"]).isRequired},function(e){function t(){const e=document.getElementById("registration-detail-registration-tags-assign");if(e){const t=JSON.parse(e.dataset.assignedTags),i=JSON.parse(e.dataset.allTags),{eventId:r,regformId:s,registrationId:l}=e.dataset;n.render(a.createElement(le,{eventId:parseInt(r,10),regformId:parseInt(s,10),registrationId:parseInt(l,10),assignedTags:t,allTags:i}),e)}}function i(){const e=document.getElementById("registration-summary-consent-to-publish");if(e){const{locator:t,publishToParticipants:i,publishToPublic:r,initialConsentToPublish:s}=e.dataset;n.render(a.createElement(A,{locator:JSON.parse(t),publishToParticipants:i,publishToPublic:r,initialConsentToPublish:s}),e)}}$(document).ready((function(){$(".js-regform-schedule-dialog").on("click",(function(e){e.preventDefault(),ajaxDialog({url:$(this).data("href"),title:$(this).data("title"),onClose(e){e&&location.reload()}})})),$(".js-check-conditions").on("click",(function(e){const t=$("#conditions-accepted");if(t.length&&!t.prop("checked")){const t="Please, confirm that you have read and accepted the Terms and Conditions before proceeding.";alertPopup($T.gettext(t),$T.gettext("Terms and Conditions")),e.preventDefault()}})),$(".js-highlight-payment").on("click",(function(){$("#payment-summary").effect("highlight",800)}))})),$(window).scroll((function(){IndicoUI.Effect.followScroll()})),e.setupRegistrationFormListPage=function(){$("#payment-disabled-notice").on("indico:confirmed",".js-enable-payments",(function(e){e.preventDefault();const t=$(this);$.ajax({url:t.data("href"),method:t.data("method"),complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(e){$("#payment-disabled-notice").remove(),$("#event-side-menu").html(e.event_menu)}})}))},document.addEventListener("DOMContentLoaded",(()=>{t(),$("#registration-details").parent().on("indico:htmlUpdated",t)})),document.addEventListener("DOMContentLoaded",(()=>{i(),$("#registration-info").parent().on("indico:htmlUpdated",i)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("registration-form-setup-container");e&&va(e);const t=document.getElementById("registration-form-submission-container");t&&Aa(t)})),customElements.define("ind-conference-participant-list",class extends HTMLElement{connectedCallback(){D.Q.then((()=>{n.render(a.createElement(ee,{tables:JSON.parse(this.getAttribute("tables")),totalParticipantCount:Number(this.getAttribute("total-participant-count")),preview:this.getAttribute("preview"),published:null!==this.getAttribute("published"),merged:null!==this.getAttribute("merged"),eventId:Number(this.getAttribute("event-id"))}),this)}))}disconnectedCallback(){n.unmountComponentAtNode(this)}})}(window)}},e=>{e.O(0,[4644,4394,2076],(()=>{return t=52825,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.registration.00e371be.bundle.js.map